<!doctype html>
<html lang="ar" dir="rtl">
 <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Ù†Ø¸Ø§Ù… Ø§Ù„ØªÙ‚ÙˆÙŠÙ… Ø§Ù„Ù…Ø¯Ø±Ø³ÙŠ</title>
  <script src="/_sdk/element_sdk.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <style>
    :root {
      --bg: #f6f8fb;
      --card: #ffffff;
      --soft: #f0f4f8;
      --text: #233042;
      --muted: #6b7a90;
      --brand: #7cc4ad;
      --brand-2: #9cc6e0;
      --accent: #b7c3d0;
      --danger: #f28b82;
      --ring: rgba(124, 196, 173, 0.35);
    }

    body {
      box-sizing: border-box;
    }
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html, body {
      height: 100%;
    }

    @import url('https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700&display=swap');

    body {
      font-family: "Tajawal", "Segoe UI", Tahoma, sans-serif;
      background: var(--bg);
      color: var(--text);
      min-height: 100%;
      padding: 16px;
      direction: rtl;
      width: 100%;
      line-height: 1.6;
    }

    .container {
      max-width: 1400px;
      margin: 0 auto;
      width: 100%;
    }

    .app-header {
      text-align: center;
      margin-bottom: 1.5rem;
      padding: 1rem;
      background: linear-gradient(90deg, var(--brand), var(--brand-2));
      border-radius: 16px;
      box-shadow: 0 2px 18px rgba(0, 0, 0, 0.06);
    }

    .app-header h1 {
      font-size: 1.5rem;
      color: #0d2a1f;
      margin-bottom: 0.5rem;
    }

    .app-header .muted {
      margin: 0;
      color: #204a3e;
      font-size: 0.9rem;
    }

    .muted {
      color: var(--muted);
      font-size: 13px;
    }

    .card {
      background: var(--card);
      padding: 16px;
      border-radius: 16px;
      box-shadow: 0 8px 24px rgba(35, 48, 66, 0.05);
      margin-bottom: 16px;
      width: 100%;
      border: 1px solid #e8edf3;
    }

    .card-soft {
      background: var(--soft);
      border: 1px dashed #d9e2ec;
      border-radius: 14px;
      padding: 12px;
    }

    .section-title {
      font-size: 18px;
      color: var(--text);
      margin: 0 0 10px;
      padding-bottom: 0.5rem;
      border-bottom: 2px solid var(--brand);
    }

    .menu {
      list-style: none;
      display: grid;
      gap: 8px;
      margin: 0;
      padding: 0;
    }

    .menu-btn {
      width: 100%;
      padding: 12px 14px;
      font-size: 1rem;
      background: #fff;
      color: var(--text);
      border: 1px solid #dde5ee;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-weight: 700;
      text-align: right;
    }

    .menu-btn:hover {
      border-color: var(--brand);
      transform: translateY(-1px);
    }

    .menu-btn:active {
      transform: translateY(0);
    }

    .login-card {
      background: var(--soft);
      padding: 12px;
      border-radius: 12px;
      margin-top: 12px;
      border: 1px dashed #d9e2ec;
    }

    .login-card h3 {
      color: var(--brand);
      margin-bottom: 1rem;
      font-size: 1.1rem;
    }

    .hidden {
      display: none !important;
    }

    .row {
      display: flex;
      gap: 10px;
      margin-bottom: 10px;
      align-items: center;
    }

    .wrap {
      flex-wrap: wrap;
    }

    .end {
      justify-content: flex-end;
    }

    .row label {
      font-size: 14px;
      color: var(--muted);
      min-width: 120px;
    }

    input, select {
      flex: 1;
      padding: 10px 12px;
      border: 1px solid #dfe7f1;
      border-radius: 10px;
      font-size: 1rem;
      background: #fff;
      color: var(--text);
      outline: none;
      min-width: 200px;
    }

    input:focus, select:focus {
      box-shadow: 0 0 0 3px var(--ring);
      border-color: var(--brand);
    }

    button {
      padding: 10px 12px;
      font-size: 1rem;
      background: linear-gradient(90deg, var(--brand), var(--brand-2));
      color: #0f2b21;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-weight: 700;
      letter-spacing: 0.2px;
    }

    button:hover {
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(124, 196, 173, 0.3);
    }

    button:disabled {
      background: #cbd5e0;
      cursor: not-allowed;
      transform: none;
      opacity: 0.6;
    }

    button.ghost {
      background: #fff;
      color: var(--text);
      border: 1px dashed #d9e2ec;
    }

    button.ghost:hover {
      background: var(--soft);
      border-color: var(--brand);
    }

    button.danger {
      background: linear-gradient(90deg, var(--danger), #f7b0aa);
      color: #4b0e0c;
    }

    .hint {
      margin-top: 0.75rem;
      font-size: 12px;
      color: #2a6b56;
      font-style: italic;
    }

    /* Modal Styles */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.6);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      padding: 20px;
    }

    .modal-overlay.active {
      display: flex;
    }

    .modal-content {
      background: white;
      border-radius: 16px;
      padding: 24px;
      max-width: 600px;
      width: 100%;
      max-height: 80%;
      overflow-y: auto;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
    }

    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      padding-bottom: 15px;
      border-bottom: 2px solid var(--brand);
    }

    .modal-header h3 {
      color: var(--brand);
      font-size: 1.3rem;
      margin: 0;
    }

    .modal-close {
      background: #f0f4f8;
      color: var(--text);
      border: none;
      width: 32px;
      height: 32px;
      border-radius: 50%;
      font-size: 1.2rem;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 0;
    }

    .modal-close:hover {
      background: var(--danger);
      color: white;
    }

    .modal-body {
      margin-bottom: 20px;
    }

    .modal-footer {
      display: flex;
      gap: 10px;
      justify-content: flex-end;
    }

    @media (max-width: 768px) {
      body {
        padding: 8px;
      }
      
      .app-header h1 {
        font-size: 1.25rem;
      }
      
      .card {
        padding: 12px;
      }
      
      .row {
        flex-direction: column;
        align-items: stretch;
      }
      
      .row label {
        min-width: auto;
      }
    }
  </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
  <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>
 </head>
 <body>
  <main class="container">
   <section id="loginMenu" class="card">
    <div class="app-header">
     <h1>Ù„ÙˆØ­Ø© Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„ØªÙ‚ÙˆÙŠÙ… Ø§Ù„Ø°Ø§ØªÙŠØ©</h1>
     <p class="muted">Ù…ØªØ§Ø¨Ø¹Ø© Ù„Ø£Ø¯Ø§Ø¡ Ø§Ù„Ø·Ø§Ù„Ø¨Ø© ÙÙŠ Ù…Ø§Ø¯Ø© ØªÙ‚Ù†ÙŠØ© Ø±Ù‚Ù…ÙŠØ© Ù„Ø¹Ø§Ù… 1447 Ù‡Ù€</p>
    </div>
    <h2 class="section-title">Ø§Ø®ØªØ§Ø±ÙŠ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©</h2>
    <ul class="menu">
     <li><button class="menu-btn" id="showTeacher">ğŸ« Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø¹Ù„Ù…Ø©</button></li>
     <li><button class="menu-btn" id="showStudent">ğŸ‘§ Ù„ÙˆØ­Ø© Ø§Ù„Ø·Ø§Ù„Ø¨Ø©</button></li>
     <li><button class="menu-btn" id="showParent">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ Ù„ÙˆØ­Ø© ÙˆÙ„ÙŠÙ‘ Ø§Ù„Ø£Ù…Ø±</button></li>
    </ul>
    <div id="teacherLogin" class="login-card hidden">
     <h3>Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø¹Ù„Ù…Ø©</h3>
     <div class="row"><label for="teacherCode">Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ</label> <input id="teacherCode" type="password" inputmode="numeric" placeholder="****">
     </div>
     <div class="row"><button id="teacherEnter">Ø¯Ø®ÙˆÙ„</button> <button class="ghost" id="closeTeacher">Ø¥ØºÙ„Ø§Ù‚</button>
     </div>
     <p class="hint">ØªÙ„Ù…ÙŠØ­: Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ Ù‡Ùˆ 1234</p>
    </div>
    <div id="studentLogin" class="login-card hidden">
     <h3>Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø·Ø§Ù„Ø¨Ø©</h3>
     <div class="row"><label for="studentNameInput">Ø§Ù„Ø§Ø³Ù…</label> <input id="studentNameInput" type="text" placeholder="Ù…Ø«Ø§Ù„: Ø³Ø§Ø±Ø© Ù…Ø­Ù…Ø¯">
     </div>
     <div class="row"><button id="studentEnter">Ø¹Ø±Ø¶ ØªÙ‚Ø±ÙŠØ±ÙŠ</button> <button class="ghost" id="closeStudent">Ø¥ØºÙ„Ø§Ù‚</button>
     </div>
    </div>
    <div id="parentLogin" class="login-card hidden">
     <h3>Ø¯Ø®ÙˆÙ„ ÙˆÙ„ÙŠÙ‘ Ø§Ù„Ø£Ù…Ø±</h3>
     <div class="row"><label for="parentNameInput">Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„ï¿½ï¿½ï¿½ï¿½Ø©</label> <input id="parentNameInput" type="text" placeholder="Ù…Ø«Ø§Ù„: Ø³Ø§Ø±Ø© Ù…Ø­Ù…Ø¯">
     </div>
     <div class="row"><button id="parentEnter">Ø¹Ø±Ø¶ ØªÙ‚Ø±ÙŠØ± ÙˆÙ„ÙŠÙ‘ Ø§Ù„Ø£Ù…Ø±</button> <button class="ghost" id="closeParent">Ø¥ØºÙ„Ø§Ù‚</button>
     </div>
    </div>
    <div class="card-soft" style="margin-top: 1.5rem; background: linear-gradient(135deg, #fef5e7, #fef9e7); border: 2px solid #f9e79f; border-radius: 16px; box-shadow: 0 4px 15px rgba(249, 231, 159, 0.2);">
     <h3 style="color: #d68910; font-size: 1.1rem; margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;"><span style="font-size: 1.5rem;">ğŸ†</span> <span>Ø§Ù„Ø£Ø³Ø± Ø§Ù„Ø£ÙƒØ«Ø± ØªÙØ§Ø¹Ù„Ø§Ù‹</span></h3>
     <div id="topFamiliesContainer" style="display: flex; gap: 1rem; flex-wrap: wrap; justify-content: center; align-items: center; min-height: 80px;">
      <p style="color: #7a8fa8; font-style: italic; font-size: 0.9rem;">Ù„Ø§ ØªÙˆØ¬Ø¯ ØªÙØ§Ø¹Ù„Ø§Øª Ø¨Ø¹Ø¯</p>
     </div>
    </div>
    <div class="card-soft" style="margin-top: 1.5rem; background: linear-gradient(135deg, #e8f5e9, #f1f8e9); border: 2px solid #81c784; border-radius: 16px; box-shadow: 0 4px 15px rgba(129, 199, 132, 0.2);">
     <h3 style="color: #2e7d32; font-size: 1.1rem; margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;"><span style="font-size: 1.5rem;">â­</span> <span>Ø§Ù„Ø·Ø§Ù„Ø¨Ø§Øª Ø§Ù„Ø£ÙƒØ«Ø± ØªÙ…ÙŠØ²Ø§Ù‹</span></h3>
     <div id="topStudentsContainer" style="display: flex; gap: 1rem; flex-wrap: wrap; justify-content: center; align-items: stretch; min-height: 120px;">
      <p style="color: #7a8fa8; font-style: italic; font-size: 0.9rem;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ø¹Ø¯</p>
     </div>
    </div>
   </section>
   <section id="teacherPanel" class="card hidden">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; flex-wrap: wrap; gap: 10px;">
     <h2 class="section-title">ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø¹Ù„Ù…Ø©</h2><button id="backToMenu1">ğŸ  Ø¹ÙˆØ¯Ø© Ù„Ù„Ù‚Ø§Ø¦Ù…Ø©</button>
    </div>
    <div style="display: flex; gap: 8px; flex-wrap: wrap; margin-bottom: 1rem;"><button id="addStudentBtn">â• Ø¥Ø¶Ø§ÙØ© Ø·Ø§Ù„Ø¨Ø©</button> <button class="ghost" id="demoBtn">ğŸ“Š Ø¨ÙŠØ§Ù†Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ©</button> <button class="ghost" id="importCSV">ğŸ“‚ Ø§Ø³ØªÙŠØ±Ø§Ø¯ CSV</button> <button class="ghost" id="importExcel">ğŸ“¥ Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§ÙƒØ³Ù„</button> <button class="ghost" id="importPlansExcel">ï¿½ï¿½ï¿½ Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø®Ø·Ø· Ø§ÙƒØ³Ù„</button> <button class="ghost" id="exportExcel">ğŸ’¾ ØªØµØ¯ÙŠØ± Excel</button> <button class="ghost" id="clearBtn">ğŸ—‘ï¸ Ù…Ø³Ø­ Ø§Ù„ÙƒÙ„</button> <button id="saveDataBtn">ğŸ’¾ Ø­ÙØ¸ ï¿½ï¿½Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
    </div><input type="file" id="csvFileInput" accept=".csv" style="display: none;"> <input type="file" id="excelFileInput" accept=".xlsx,.xls" style="display: none;"> <input type="file" id="plansExcelFileInput" accept=".xlsx,.xls" style="display: none;">
    <div class="card-soft" style="margin-bottom: 1rem;">
     <h4 style="margin-bottom: 1rem; color: var(--brand); font-size: 1.1rem; display: flex; align-items: center; gap: 0.5rem;"><span style="font-size: 1.3rem;">ğŸ“Š</span> <span>Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª ÙˆØ®Ø·Ø·</span></h4>
     <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 10px; margin-bottom: 1rem;">
      <div style="padding: 10px 12px; background: white; border-radius: 8px; box-shadow: 0 2px 6px rgba(0,0,0,0.05);">
       <p style="font-size: 0.75rem; color: var(--muted); margin-bottom: 0.25rem;">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø·Ø§Ù„Ø¨Ø§Øª</p><strong id="countStudents" style="font-size: 1.25rem; color: var(--brand);">0</strong>
      </div>
      <div style="padding: 10px 12px; background: white; border-radius: 8px; box-shadow: 0 2px 6px rgba(0,0,0,0.05);">
       <p style="font-size: 0.75rem; color: var(--muted); margin-bottom: 0.25rem;">Ù…Ø¹Ø¯Ù„ Ø§Ù„ÙØµÙ„</p><strong id="classAvg" style="font-size: 1.25rem; color: var(--brand);">0</strong>
      </div>
      <div style="padding: 10px 12px; background: white; border-radius: 8px; box-shadow: 0 2px 6px rgba(0,0,0,0.05);">
       <p style="font-size: 0.75rem; color: var(--muted); margin-bottom: 0.25rem;">Ù†ï¿½ï¿½Ø¨Ø© Ø§Ù„Ø­Ø¶ÙˆØ±</p><strong id="attendanceRate" style="font-size: 1.25rem; color: #2e7d32;">0%</strong>
      </div>
      <div style="padding: 10px 12px; background: white; border-radius: 8px; box-shadow: 0 2px 6px rgba(0,0,0,0.05);">
       <p style="font-size: 0.75rem; color: var(--muted); margin-bottom: 0.25rem;">Ø®Ø·Ø· Ù…ØªØ£Ø®Ø±Ø© ğŸ”´</p><strong id="overduePlans" style="font-size: 1.25rem; color: #d32f2f;">0</strong>
      </div>
      <div style="padding: 10px 12px; background: white; border-radius: 8px; box-shadow: 0 2px 6px rgba(0,0,0,0.05);">
       <p style="font-size: 0.75rem; color: var(--muted); margin-bottom: 0.25rem;">Ù…Ø³ØªØ­Ù‚Ø© Ù‚Ø±ÙŠØ¨Ù‹Ø§ (&lt;3Ø£ÙŠØ§Ù…) ğŸŸ¡</p><strong id="dueSoonPlans" style="font-size: 1.25rem; color: #f57c00;">0</strong>
      </div>
      <div style="padding: 10px 12px; background: white; border-radius: 8px; box-shadow: 0 2px 6px rgba(0,0,0,0.05);">
       <p style="font-size: 0.75rem; color: var(--muted); margin-bottom: 0.25rem;">Ù…Ø³ØªØ­Ù‚Ø© Ø§Ù„ÙŠÙˆÙ… ğŸ”µ</p><strong id="dueTodayPlans" style="font-size: 1.25rem; color: #1976d2;">0</strong>
      </div>
     </div>
     <div style="text-align: center;"><button class="ghost" id="clearFilter" style="font-size: 0.9rem; padding: 8px 14px;">â†º Ø¥Ù„ØºØ§Ø¡ Ø§Ù„ÙÙ„ØªØ±</button>
     </div>
    </div>
    <div style="overflow: auto; border-radius: 12px; border: 1px solid #e8edf3;">
     <table id="gradesTable" style="width: 100%; border-collapse: separate; border-spacing: 0; font-size: 13px;">
      <thead>
       <tr style="background: #f5f9fc;">
        <th style="padding: 10px 6px; text-align: center; border-bottom: 2px solid var(--brand); min-width: 120px;">Ø§Ù„Ø§Ø³Ù…</th>
        <th style="padding: 10px 6px; text-align: center; border-bottom: 2px solid var(--brand);">Ø§Ù„ÙØµÙ„</th>
        <th style="padding: 10px 6px; text-align: center; border-bottom: 2px solid var(--brand);">Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª<br><small>(20)</small></th>
        <th style="padding: 10px 6px; text-align: center; border-bottom: 2px solid var(--brand);">Ø§Ù„Ø¹Ù…Ù„ÙŠ<br><small>(30)</small></th>
        <th style="padding: 10px 6px; text-align: center; border-bottom: 2px solid var(--brand);">Ø§Ù„ÙˆØ§Ø¬Ø¨Ø§Øª<br><small>(30)</small></th>
        <th style="padding: 10px 6px; text-align: center; border-bottom: 2px solid var(--brand);">Ø§Ù„Ù…Ù†Ø§Ù‚Ø´Ø§Øª<br><small>(20)</small></th>
        <th style="padding: 10px 6px; text-align: center; border-bottom: 2px solid var(--brand); min-width: 150px;">Ø§Ù„ØªØ¹Ø§ÙˆÙ†<br><small>(Ù…Ø¬Ù…ÙˆØ¹Ø©)</small></th>
        <th style="padding: 10px 6px; text-align: center; border-bottom: 2px solid var(--brand); min-width: 180px;">Ù†Ù‚Ø§Ø·<br>
         Ø§Ù„ØªÙ…ÙŠØ²</th>
        <th style="padding: 10px 6px; text-align: center; border-bottom: 2px solid var(--brand); min-width: 180px;">Ù†Ù‚Ø§Ø·<br>
         Ø§Ù„Ù‚ÙˆØ©</th>
        <th style="padding: 10px 6px; text-align: center; border-bottom: 2px solid var(--brand); min-width: 180px;">Ù†Ù‚Ø§Ø·<br>
         Ø§Ù„Ø¶Ø¹Ù</th>
        <th style="padding: 10px 6px; text-align: center; border-bottom: 2px solid var(--brand);">Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹<br><small>(100)</small></th>
        <th style="padding: 10px 6px; text-align: center; border-bottom: 2px solid var(--brand); min-width: 200px;">Ø®Ø·Ø© Ø±ÙØ¹<br>
         Ø§Ù„Ù…Ø³ØªÙˆÙ‰</th>
        <th style="padding: 10px 6px; text-align: center; border-bottom: 2px solid var(--brand); min-width: 150px;">Ø­Ø§Ù„Ø©<br>
         Ø§Ù„Ø·Ø§Ù„Ø¨Ø©</th>
        <th style="padding: 10px 6px; text-align: center; border-bottom: 2px solid var(--brand); min-width: 150px;">ØªÙˆï¿½ï¿½ØµÙ„<br>
         ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø±</th>
        <th style="padding: 10px 6px; text-align: center; border-bottom: 2px solid var(--brand);">Ø§Ù„Ø­Ø¶ÙˆØ±<br><small>(Ø£ÙŠØ§Ù…)</small></th>
        <th style="padding: 10px 6px; text-align: center; border-bottom: 2px solid var(--brand);">Ø­Ø°Ù</th>
       </tr>
      </thead>
      <tbody id="gradesTableBody">
       <tr>
        <td colspan="16" style="text-align: center; padding: 3rem 1rem; color: var(--muted);">
         <div style="font-size: 3rem;">
          ğŸ“š
         </div><p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ø§Ù„Ø¨Ø§Øª Ø¨Ø¹Ø¯</p></td>
       </tr>
      </tbody>
     </table>
    </div>
    <div style="margin-top: 16px; text-align: center; display: flex; gap: 10px; justify-content: center; flex-wrap: wrap;"><button id="saveAfterTableBtn">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª</button> <button class="ghost" id="printSummary">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø© Ù…Ø®ØªØµØ±Ø©</button>
    </div>
   </section>
   <section id="studentPanel" class="card hidden">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; flex-wrap: wrap; gap: 10px;">
     <h2 class="section-title">Ù„ÙˆØ­Ø© Ø§Ù„Ø·Ø§Ù„Ø¨Ø©</h2><button id="backToMenu2" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);">ğŸ  Ø¹ÙˆØ¯Ø© Ù„Ù„Ù‚Ø§Ø¦Ù…Ø©</button>
    </div>
    <div id="studentReport">
     <div style="text-align: center; margin-bottom: 2rem;">
      <h3 style="font-size: 1.5rem; color: var(--brand);">Ù…Ø±Ø­Ø¨Ù‹Ø§ <span id="sName">Ø§Ù„Ø·Ø§Ù„Ø¨Ø©</span></h3>
      <p style="color: var(--muted);">Ø§Ù„ÙØµÙ„: <span id="sClass">â€”</span></p>
     </div>
     <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin: 1rem 0;">
      <div style="background: linear-gradient(90deg, var(--brand), var(--brand-2)); color: #0d2a1f; padding: 1.5rem; border-radius: 12px; text-align: center; box-shadow: 0 4px 12px rgba(124, 196, 173, 0.2);">
       <h4 style="font-size: 0.9rem; margin-bottom: 0.5rem; opacity: 0.9;">Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙƒÙ„ÙŠ</h4>
       <div style="font-size: 2rem; font-weight: bold;">
        <span id="sTotal">0</span>/100
       </div>
      </div>
      <div style="background: linear-gradient(90deg, var(--brand), var(--brand-2)); color: #0d2a1f; padding: 1.5rem; border-radius: 12px; text-align: center; box-shadow: 0 4px 12px rgba(124, 196, 173, 0.2);">
       <h4 style="font-size: 0.9rem; margin-bottom: 0.5rem; opacity: 0.9;">Ù†Ø³Ø¨Ø© Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²</h4>
       <div style="height: 20px; border-radius: 999px; background: #e8edf3; overflow: hidden; margin-top: 1rem;"><span id="sProgress" style="display: block; height: 100%; background: linear-gradient(90deg, #48bb78, #38a169); transition: width 0.3s ease; width: 0%;"></span>
       </div>
      </div>
     </div>
     <div class="card-soft" style="margin-top: 1rem;">
      <h4 style="margin-bottom: 1rem; color: var(--brand);">Ø£Ø¯Ø§Ø¦ÙŠ Ø§Ù„ØªÙØµÙŠÙ„ÙŠ</h4>
      <div id="sDetails">
       <p style="color: var(--muted); text-align: center;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù…ØªØ§Ø­Ø©</p>
      </div>
     </div>
     <div class="card-soft" style="margin-top: 1rem; background: linear-gradient(135deg, #f3e5f5, #fce4ec); border: 2px solid #ce93d8;">
      <h4 style="color: #8e24aa; margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;"><span style="font-size: 1.3rem;">ğŸ“</span> <span>ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù…Ø¹Ù„Ù…Ø©</span></h4>
      <div id="sEvaluation" style="display: grid; gap: 1rem;">
       <div style="background: white; padding: 1rem; border-radius: 10px; border-right: 4px solid #66bb6a;">
        <p style="font-weight: 700; color: #2e7d32; margin-bottom: 0.5rem; display: flex; align-items: center; gap: 0.5rem;"><span style="font-size: 1.2rem;">âœ¨</span> <span>Ù†Ù‚Ø§Ø· Ø§Ù„ØªÙ…ÙŠØ²</span></p>
        <p id="sExcellence" style="color: var(--text); line-height: 1.6; font-size: 0.95rem;">â€”</p>
       </div>
       <div style="background: white; padding: 1rem; border-radius: 10px; border-right: 4px solid #42a5f5;">
        <p style="font-weight: 700; color: #1565c0; margin-bottom: 0.5rem; display: flex; align-items: center; gap: 0.5rem;"><span style="font-size: 1.2rem;">ğŸ’ª</span> <span>Ù†Ù‚Ø§Ø· Ø§Ù„Ù‚ÙˆØ©</span></p>
        <p id="sStrengths" style="color: var(--text); line-height: 1.6; font-size: 0.95rem;">â€”</p>
       </div>
       <div style="background: white; padding: 1rem; border-radius: 10px; border-right: 4px solid #ff7043;">
        <p style="font-weight: 700; color: #d84315; margin-bottom: 0.5rem; display: flex; align-items: center; gap: 0.5rem;"><span style="font-size: 1.2rem;">ğŸ“‹</span> <span>ï¿½ï¿½ï¿½ï¿½Ù‚Ø§Ø· Ø§Ù„Ø¶Ø¹Ù</span></p>
        <p id="sWeaknesses" style="color: var(--text); line-height: 1.6; font-size: 0.95rem;">â€”</p>
       </div>
       <div style="background: white; padding: 1rem; border-radius: 10px; border-right: 4px solid #9c27b0;">
        <p style="font-weight: 700; color: #6a1b9a; margin-bottom: 0.5rem; display: flex; align-items: center; gap: 0.5rem;"><span style="font-size: 1.2rem;">ğŸ¯</span> <span>Ø§Ù„Ø®Ø·Ø© Ø§Ù„Ø¹Ù„Ø§Ø¬ÙŠØ©</span></p>
        <p id="sImprovementPlan" style="color: var(--text); line-height: 1.6; font-size: 0.95rem;">â€”</p>
       </div>
      </div>
     </div>
     <div class="card-soft" style="margin-top: 1rem; background: linear-gradient(135deg, #e3f2fd, #e8eaf6); border: 2px solid #64b5f6;">
      <h4 style="color: #1565c0; margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;"><span style="font-size: 1.3rem;">ğŸ“Š</span> <span>Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ Ù„Ø£Ø¯Ø§Ø¦ÙŠ</span></h4>
      <div style="position: relative; background: white; padding: 1.5rem; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.05);">
       <canvas id="studentChart" style="max-height: 300px;"></canvas>
       <div id="needsSupportWarning" style="display: none; margin-top: 1rem; padding: 12px; background: #fff3e0; border: 2px solid #ff9800; border-radius: 8px; text-align: center;">
        <p style="color: #e65100; font-weight: 700; font-size: 0.95rem; margin: 0;">âš ï¸ ÙŠÙˆØ¬Ø¯ Ù…Ø¬Ø§Ù„ ÙŠØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ Ø¯Ø¹Ù…</p>
       </div>
      </div>
     </div>
     <div class="card-soft" style="margin-top: 1rem; background: #fef5e7;">
      <h4 style="color: #d68910; margin-bottom: 0.5rem;">ğŸ’¡ Ù†ØµÙŠØ­Ø© Ù„Ù„ØªØ·ÙˆÙŠØ±</h4>
      <p id="sTip" style="font-size: 0.95rem; color: var(--text);">Ø§Ø³ØªÙ…Ø±ÙŠ ÙÙŠ Ø¨Ø°Ù„ Ø§Ù„Ø¬Ù‡Ø¯ ÙˆØ³ØªØ­Ù‚Ù‚ÙŠÙ† Ù†ØªØ§Ø¦Ø¬ Ø±Ø§Ø¦Ø¹Ø©! ğŸŒŸ</p>
     </div>
     <div class="card-soft" style="margin-top: 1rem; background: linear-gradient(135deg, #dcf8e8, #e8f5e9); border: 2px solid #25D366;">
      <h4 style="color: #128C7E; margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;"><span style="font-size: 1.3rem;">ğŸ“</span> <span>Ø¨ØµÙØªÙƒ Ø·Ø§Ù„Ø¨Ø© Ø´Ø§Ø±ÙƒÙŠ Ù…Ø¹Ù„Ù…ØªÙƒ</span></h4>
      <div style="margin-bottom: 1.25rem;"><label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: #2e7d32; font-size: 0.95rem;">âœ¨ ØµÙØ© Ø£ØªØ­Ù„Ù‰ Ø¨Ù‡Ø§</label>
       <p style="font-size: 0.85rem; color: #5a8165; margin-bottom: 0.5rem; font-style: italic;">Ù…Ø«Ø§Ù„: Ø®Ø¬ÙˆÙ„Ø©ØŒ Ø¬Ø±ÙŠØ¦Ø©ØŒ Ù…ØªØ³Ø±Ø¹Ø©ØŒ Ø§Ù†ÙØ¹Ø§Ù„ÙŠØ©...</p><select id="studentTrait" style="width: 100%; padding: 10px; border: 1px solid #81c784; border-radius: 10px; background: white; color: #2e7d32;"> <option value="">Ø§Ø®ØªØ± ØµÙØ©...</option> <option value="Ø®Ø¬ÙˆÙ„Ø©">Ø®Ø¬ÙˆÙ„Ø©</option> <option value="Ø¬Ø±ÙŠØ¦Ø©">Ø¬Ø±ÙŠØ¦Ø©</option> <option value="Ù…ØªØ³Ø±Ø¹Ø©">Ù…ØªØ³Ø±Ø¹Ø©</option> <option value="Ø§Ù†ÙØ¹Ø§Ù„ÙŠØ©">Ø§Ù†ÙØ¹Ø§Ù„ÙŠØ©</option> <option value="Ù‡Ø§Ø¯Ø¦Ø©">Ù‡Ø§Ø¯Ø¦Ø©</option> <option value="Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ©">Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ©</option> <option value="Ù…Ù†Ø¸Ù…Ø©">Ù…Ù†Ø¸Ù…Ø©</option> <option value="Ù…Ø¨Ø¯Ø¹Ø©">Ù…Ø¨Ø¯Ø¹Ø©</option> </select>
      </div>
      <div style="margin-bottom: 1rem;"><label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: #2e7d32; font-size: 0.95rem;">ğŸ¯ Ù…Ù‡Ø§Ø±Ø© Ø£ØªÙ…ÙŠØ² Ø¨Ù‡Ø§</label>
       <p style="font-size: 0.85rem; color: #5a8165; margin-bottom: 0.5rem; font-style: italic;">Ù…Ø«Ø§Ù„: ï¿½ï¿½Ù„Ø±Ø³Ù…ØŒ Ø§Ù„ØªØµÙ…ÙŠÙ…ØŒ Ø­Ù„ Ø§Ù„Ù…Ø´ÙƒÙ„Ø§Øª...</p><input type="text" id="studentSkill" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ù…Ù‡Ø§Ø±Ø© ï¿½ï¿½Ù†Ø§..." style="width: 100%; padding: 10px; border: 1px solid #81c784; border-radius: 10px; background: white; color: #2e7d32;">
      </div>
     </div>
     <div class="card-soft" style="margin-top: 1rem; background: linear-gradient(135deg, #fff3e0, #ffe0b2); border: 2px solid #ffb74d;">
      <h4 style="color: #f57c00; margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;"><span style="font-size: 1.3rem;">ğŸ“</span> <span>Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ© Ø§Ù„ØªØ¹Ù„Ù… Ø§Ù„Ù…ÙØ¶Ù„Ø©</span></h4>
      <div style="background: white; padding: 1rem; border-radius: 10px; margin-bottom: 1.25rem; border-right: 4px solid #ff9800;">
       <p style="font-size: 0.9rem; line-height: 1.7; color: #424242;">ÙÙŠ Ù…Ø§Ø¯Ø© Ø§Ù„ØªÙ‚Ù†ÙŠØ© Ø§Ù„Ø±Ù‚Ù…ÙŠØ© ï¿½ï¿½Ø­Ø±Øµ Ø¹Ù„Ù‰ ØªÙ†Ù…ÙŠï¿½ï¿½ Ù…Ù‡Ø§Ø±Ø§ØªÙƒ Ø§Ù„ØªÙÙƒÙŠØ± Ø§Ù„Ù†Ø§Ù‚Ø¯ ÙˆØ§Ù„Ø¥Ø¨Ø¯Ø§Ø¹ÙŠ ÙˆØ­Ù„ Ø§Ù„Ù…Ø´ÙƒÙ„Ø§Øª Ù…Ù† Ø®Ù„Ø§Ù„ ØªÙˆï¿½ï¿½ÙŠÙÙ‡Ø§ ÙÙŠ Ø£Ù†Ø´ï¿½ï¿½ï¿½ï¿½ ØªØ¹Ù„ÙŠÙ…ÙŠØ© ØªØ¹Ø§ÙˆÙ†ÙŠØ©ØŒ ÙØ±Ø¯ÙŠØ©ØŒ Ø±Ù‚Ù…ÙŠØ©.</p>
      </div>
      <div style="margin-bottom: 1.25rem;"><label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: #e65100; font-size: 0.95rem;">ğŸ“ Ù‡Ù„ Ù‡Ù†Ø§Ùƒ Ø·Ø±ÙŠÙ‚Ø© Ù…Ø¹ÙŠÙ†Ø© (Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ© ØªØ¹Ù„ÙŠÙ…ÙŠØ© Ù…Ø­Ø¯Ø¯Ø©) ØªÙÙ‡Ù…ÙŠÙ† Ù…Ù† Ø®Ù„Ø§Ù„Ù‡Ø§ Ø§Ù„Ø¯Ø±Ø³ØŸ Ø¥Ù† ÙˆØ¬Ø¯Øª Ø´Ø§Ø±ÙƒÙŠÙ†Ø§</label>
       <p style="font-size: 0.85rem; color: #8a6d3b; margin-bottom: 0.5rem; font-style: italic;">Ù…Ø«Ø§Ù„: Ø§Ù„ØªØ¹Ù„Ù… Ø¨Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹ØŒ Ø§Ù„ØªØ¹Ù„Ù… Ø§Ù„ØªØ¹Ø§ÙˆÙ†ÙŠØŒ Ø§Ù„ØªØ¹Ù„Ù… Ø§Ù„Ø°Ø§ØªÙŠ...</p><input type="text" id="learningStrategy" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ© Ø§Ù„Ù…ÙØ¶Ù„Ø©..." style="width: 100%; padding: 10px; border: 1px solid #ffb74d; border-radius: 10px; background: white; color: #e65100;">
      </div>
      <div style="margin-bottom: 1rem;"><label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: #e65100; font-size: 0.95rem;">ï¿½ï¿½ï¿½ ØªÙ… Ø§Ø³ØªØ¹Ø±Ø§Ø¶ Ø§Ù„Ø®Ø·Ø© Ø§Ù„Ø¹Ù„Ø§Ø¬ÙŠØ© ÙˆØ§Ù„Ø¥Ø«Ø±Ø§Ø¦ÙŠØ© Ø§Ù„ØªÙŠ Ù†ÙØ°ØªÙ‡Ø§ Ø§Ù„Ù…Ø¹Ù„Ù…Ø© Ù„Ùƒ ÙˆØ¸Ù‡Ø±Øª Ø§Ù„Ù†ØªØ§Ø¦Ø¬ØŒ Ù‡Ù„ Ù‡Ù†Ø§Ùƒ Ø·Ø±ÙŠÙ‚Ø© Ø£Ø®Ø±Ù‰ ØªØ±ØºØ¨ÙŠÙ† ÙÙŠ Ø¥Ø¶Ø§ÙØªÙ‡Ø§ Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù„Ùƒ Ø¬ÙˆØ§Ù†Ø¨ Ø¶Ø¹Ù Ù†Ø§Ù‚Ø´ï¿½ï¿½Ù‡Ø§ Ù…Ø¹Ù„Ù…ØªÙƒ Ù…Ø¹Ùƒ Ù…Ø³Ø¨Ù‚Ø§Ù‹ØŸ</label> <select id="hasAdditionalMethod" style="width: 100%; padding: 10px; border: 1px solid #ffb74d; border-radius: 10px; background: white; color: #e65100;"> <option value="">Ø§Ø®Øªï¿½ï¿½Ø±ÙŠ Ø¥Ø¬Ø§Ø¨Ø©...</option> <option value="Ù„Ø§">Ù„Ø§ØŒ Ù„Ø§ ÙŠÙˆØ¬Ø¯ (Ø£ÙƒØªÙÙŠ Ø¨Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ù…Ø¹Ù„Ù…Ø©)</option> <option value="Ù†Ø¹Ù…">Ù†Ø¹Ù… ÙŠÙˆØ¬Ø¯</option> </select>
      </div>
      <div id="additionalMethodContainer" style="margin-bottom: 1rem; display: none;"><label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: #e65100; font-size: 0.95rem;">âœï¸ Ø§ÙƒØªØ¨ÙŠ Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ© Ø§Ù„ØªÙŠ ØªØ±ØºØ¨ÙŠÙ† ÙÙŠÙ‡Ø§</label> <textarea id="additionalMethod" placeholder="Ø´Ø§Ø±ÙƒÙŠÙ†Ø§ Ø£ÙÙƒØ§Ø±Ùƒ..." style="width: 100%; min-height: 80px; padding: 10px; border: 1px solid #ffb74d; border-radius: 10px; background: white; color: #e65100; resize: vertical;"></textarea>
      </div>
     </div>
     <div class="card-soft" style="margin-top: 1rem; background: linear-gradient(135deg, #e1f5fe, #e8eaf6); border: 2px solid #64b5f6;">
      <h4 style="color: #1976d2; margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;"><span style="font-size: 1.3rem;">ğŸ“Š</span> <span>Ø§Ø³ØªØ¨ÙŠØ§Ù† Ø³Ø±ÙŠØ¹</span></h4>
      <div style="margin-bottom: 1.25rem;"><label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: #0d47a1; font-size: 0.95rem;">â“ Ø£Ù†Ø§ Ø£Ù‚ÙˆÙ… Ø¯Ø§Ø¦Ù…Ø§Ù‹ Ø¨Ø¥Ø®Ø¨Ø§Ø± ÙˆÙ„ÙŠ/Ù€Ø© Ø£Ù…Ø±ÙŠ Ø¨ØªØ­ØµÙŠÙ„ÙŠ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ ÙÙŠ Ù…Ø§Ø¯Ø© Ø§Ù„ØªÙ‚Ù†ÙŠØ© Ø§Ù„Ø±Ù‚Ù…ÙŠØ©</label> <select id="informParent" style="width: 100%; padding: 10px; border: 1px solid #64b5f6; border-radius: 10px; background: white; color: #1976d2;"> <option value="">Ø§Ø®ï¿½ï¿½Ø§Ø±ÙŠ Ø¥Ø¬Ø§Ø¨Ø©...</option> <option value="Ø¯Ø§Ø¦Ù…Ø§Ù‹">Ø¯Ø§Ø¦Ù…Ø§Ù‹ âœ…</option> <option value="ØºØ§Ù„Ø¨Ø§Ù‹">ØºØ§Ù„Ø¨Ø§Ù‹ ğŸ‘</option> <option value="Ø£Ø­ÙŠØ§Ù†Ø§Ù‹">Ø£Ø­ÙŠØ§Ù†Ø§Ù‹ ğŸ¤”</option> <option value="Ù†Ø§Ø¯Ø±Ø§Ù‹">Ù†Ø§Ø¯Ø±Ø§Ù‹ ğŸ˜</option> <option value="Ø£Ø¨Ø¯Ø§Ù‹">Ø£Ø¨Ø¯Ø§Ù‹ âŒ</option> </select>
      </div>
      <div style="margin-bottom: 1.25rem;"><label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: #0d47a1; font-size: 0.95rem;">â­ Ù…Ø§ Ù…Ø¯Ù‰ Ø±Ø¶Ø§Ùƒ Ø¹Ù† Ø¢Ù„ÙŠØ© Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø© Ù‡Ø°Ù‡ØŸ</label> <select id="satisfactionLevel" style="width: 100%; padding: 10px; border: 1px solid #64b5f6; border-radius: 10px; background: white; color: #1976d2;"> <option value="">Ø§Ø®ØªØ§Ø±ÙŠ Ø¥Ø¬Ø§Ø¨Ø©...</option> <option value="Ø±Ø§Ø¶ÙŠØ© Ø¬Ø¯Ø§Ù‹">Ø±Ø§Ø¶ÙŠØ© Ø¬Ø¯Ø§Ù‹ â­â­â­â­â­</option> <option value="Ø±Ø§Ø¶ÙŠØ©">Ø±Ø§Ø¶ÙŠØ© â­â­â­â­</option> <option value="Ù…Ø­Ø§ÙŠØ¯Ø©">Ù…Ø­Ø§ÙŠØ¯Ø© â­â­â­</option> <option value="ØºÙŠØ± Ø±Ø§Ø¶ÙŠØ©">ØºÙŠØ± Ø±Ø§Ø¶ÙŠØ© â­â­</option> <option value="ØºÙŠØ± Ø±Ø§Ø¶ÙŠØ© ØªÙ…Ø§Ù…Ø§Ù‹">ØºÙŠØ± Ø±Ø§Ø¶ÙŠØ© ØªÙ…Ø§Ù…Ø§Ù‹ â­</option> </select>
      </div><button id="submitSurvey" style="width: 100%; background: linear-gradient(90deg, #2196f3, #1976d2); color: white; padding: 12px; border-radius: 10px; font-weight: 700; font-size: 1rem;"> ğŸ“© Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø§Ø³ØªØ¨ÙŠØ§Ù† </button>
     </div>
     <div style="margin-top: 2rem; text-align: center; display: flex; gap: 10px; justify-content: center; flex-wrap: wrap;"><button onclick="contactTeacherWhatsApp()" style="background: linear-gradient(90deg, #25D366, #128C7E); color: white; padding: 12px 20px; border-radius: 10px; font-weight: 700; font-size: 1rem; display: flex; align-items: center; gap: 0.5rem; justify-content: center; border: none; cursor: pointer; box-shadow: 0 4px 12px rgba(37, 211, 102, 0.3);"> <span style="font-size: 1.3rem;">ğŸ“²</span> <span>ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ù…Ø¹Ù„Ù…Ø© Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨</span> </button> <button class="ghost">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø© / Ø­ÙØ¸ PDF</button>
     </div>
    </div>
   </section>
   <section id="parentPanel" class="card hidden">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; flex-wrap: wrap; gap: 10px;">
     <h2 class="section-title" style="background: linear-gradient(90deg, #7cc4ad, #9cc6e0); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; font-size: 1.5rem; padding: 0.5rem 0;">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ Ù„ÙˆØ­Ø© ÙˆÙ„ÙŠÙ‘ Ø§Ù„Ø£Ù…Ø±</h2><button id="backToMenu3" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);">ğŸ  Ø¹ÙˆØ¯Ø© Ù„Ù„Ù‚Ø§Ø¦Ù…Ø©</button>
    </div>
    <div id="parentReport">
     <div style="text-align: center; margin-bottom: 2rem; background: linear-gradient(135deg, #667eea15, #764ba215); padding: 1.5rem; border-radius: 16px; border: 2px solid #e0e7ff;">
      <h3 style="font-size: 1.75rem; background: linear-gradient(90deg, #667eea, #764ba2); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; font-weight: 700; margin-bottom: 1rem;">ğŸ“‹ ØªÙ‚Ø±ÙŠØ± ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø±</h3>
      <div style="display: inline-flex; gap: 1.5rem; background: white; padding: 1rem 2rem; border-radius: 12px; box-shadow: 0 4px 12px rgba(102, 126, 234, 0.15);">
       <div style="text-align: center;">
        <p style="color: #667eea; font-size: 0.85rem; margin-bottom: 0.25rem; font-weight: 600;">Ø§Ù„Ø·Ø§Ù„Ø¨Ø©</p>
        <p style="color: #2d3748; font-size: 1.1rem; font-weight: 700;"><span id="pName">â€”</span></p>
       </div>
       <div style="width: 2px; background: linear-gradient(180deg, #667eea, #764ba2); opacity: 0.3;"></div>
       <div style="text-align: center;">
        <p style="color: #764ba2; font-size: 0.85rem; margin-bottom: 0.25rem; font-weight: 600;">Ø§Ù„ÙØµÙ„</p>
        <p style="color: #2d3748; font-size: 1.1rem; font-weight: 700;"><span id="pClass">â€”</span></p>
       </div>
      </div>
     </div>
     <div class="card-soft" style="margin-top: 1rem; background: linear-gradient(135deg, #fef5e7, #fef9e7); border: 2px solid #ffd89b; border-radius: 14px;">
      <h4 style="margin-bottom: 1rem; color: #e67e22; font-size: 1.2rem; display: flex; align-items: center; gap: 0.5rem;"><span style="font-size: 1.5rem;">ğŸ“Š</span> Ù…Ù„Ø®Øµ Ø§Ù„Ø£Ø¯Ø§Ø¡</h4>
      <div id="pSummary">
       <p style="color: var(--muted); text-align: center;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù…ØªØ§Ø­Ø©</p>
      </div>
     </div>
     <div class="card-soft" style="margin-top: 1rem; background: linear-gradient(135deg, #e3f2fd, #e8eaf6); border: 2px solid #90caf9; border-radius: 16px; box-shadow: 0 4px 15px rgba(33, 150, 243, 0.1);">
      <h4 style="margin-bottom: 1rem; color: #1976d2; font-size: 1.25rem; font-weight: 700; display: flex; align-items: center; gap: 0.5rem; background: white; padding: 0.75rem 1rem; border-radius: 10px; box-shadow: 0 2px 8px rgba(25, 118, 210, 0.15);"><span style="font-size: 1.5rem;">ğŸ“</span> <span>Ø¨ØµÙØªÙƒ ÙˆÙ„ÙŠ/Ù€Ø© Ø£Ù…Ø± Ø§Ù„Ø·Ø§Ù„Ø¨Ø© Ø´Ø§Ø±Ùƒ/Ù€ÙŠ Ù…Ø¹Ù„Ù…ØªÙ‡Ø§</span></h4>
      <div style="margin-bottom: 1.25rem;"><label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: #3d5a7a; font-size: 0.95rem;">ØµÙØ© ØªØªØ­Ù„Ù‰ Ø¨Ù‡Ø§ Ø§Ù„Ø·Ø§Ù„Ø¨Ø©</label>
       <p style="font-size: 0.85rem; color: #7a8fa8; margin-bottom: 0.5rem; font-style: italic;">Ù…Ø«Ø§Ù„: Ø®Ø¬ÙˆÙ„Ø©ØŒ Ø¬Ø±ÙŠØ¦Ø©ØŒ Ù…ØªØ³Ø±Ø¹Ø©ØŒ Ø§Ù†ÙØ¹Ø§Ù„ÙŠØ©...</p><select style="width: 100%; padding: 10px; border: 1px solid #d4dfe9; border-radius: 10px; background: white; color: #3d5a7a;"> <option value="">Ø§Ø®ØªØ± ØµÙØ©...</option> <option value="Ø®Ø¬ÙˆÙ„Ø©">Ø®Ø¬ÙˆÙ„Ø©</option> <option value="Ø¬Ø±ÙŠØ¦Ø©">Ø¬Ø±ÙŠØ¦Ø©</option> <option value="Ù…ØªØ³Ø±Ø¹Ø©">Ù…ØªØ³Ø±Ø¹Ø©</option> <option value="Ø§Ù†ÙØ¹Ø§Ù„ÙŠØ©">Ø§Ù†ÙØ¹Ø§Ù„ÙŠØ©</option> <option value="Ù‡Ø§Ø¯Ø¦Ø©">Ù‡Ø§Ø¯Ø¦Ø©</option> <option value="Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ©">Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ©</option> <option value="Ù…Ù†Ø¸Ù…Ø©">Ù…Ù†Ø¸Ù…Ø©</option> <option value="Ù…Ø¨Ø¯Ø¹Ø©">Ù…Ø¨Ø¯Ø¹Ø©</option> </select>
      </div>
      <div style="margin-bottom: 1rem;"><label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: #3d5a7a; font-size: 0.95rem;">Ù…Ù‡Ø§Ø±Ø© ØªÙ†ÙØ±Ø¯ ÙˆØªØªÙ…ÙŠØ² Ø¨Ù‡Ø§</label>
       <p style="font-size: 0.85rem; color: #7a8fa8; margin-bottom: 0.5rem; font-style: italic;">Ù…Ø«Ø§Ù„: Ø§Ù„Ø±Ø³Ù…ØŒ Ø§Ù„ØªØµÙ…ÙŠÙ…ØŒ Ø­Ù„ Ø§Ù„Ù…Ø´ÙƒÙ„Ø§Øª...</p><input type="text" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ù…Ù‡Ø§Ø±Ø© Ù‡Ù†Ø§..." style="width: 100%; padding: 10px; border: 1px solid #d4dfe9; border-radius: 10px; background: white; color: #3d5a7a;">
      </div>
     </div>
     <div class="card-soft" style="margin-top: 1rem; background: linear-gradient(135deg, #fff3e0, #ffe0b2); border: 2px solid #ffb74d;">
      <h4 style="color: #f57c00; margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;"><span style="font-size: 1.3rem;">ğŸ’¡</span> <span>Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ© Ø§Ù„ØªØ¹Ù„Ù… Ø§Ù„Ù…ÙØ¶Ù„Ø©</span></h4>
      <div style="background: white; padding: 1rem; border-radius: 10px; margin-bottom: 1.25rem; border-right: 4px solid #ff9800;">
       <p style="font-size: 0.9rem; line-height: 1.7; color: #424242;">ÙÙŠ Ù…Ø§Ø¯Ø© Ø§Ù„ØªÙ‚Ù†ÙŠØ© Ø§Ù„Ø±Ù‚Ù…ÙŠØ© Ù†Ø­Ø±Øµ Ø¹Ù„Ù‰ ØªÙ†Ù…ÙŠØ© Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„ØªÙÙƒÙŠØ± Ø§Ù„Ù†Ø§Ù‚Ø¯ ÙˆØ§Ù„Ø¥Ø¨Ø¯Ø§Ø¹ÙŠ ÙˆØ­Ù„ Ø§Ù„Ù…Ø´ÙƒÙ„Ø§Øª Ù…Ù† Ø®Ù„Ø§Ù„ ØªÙˆØ¸ÙŠÙÙ‡Ø§ ÙÙŠ Ø£ï¿½ï¿½Ø´Ø·Ø© ØªØ¹Ù„ÙŠÙ…ÙŠØ© ØªØ¹Ø§ÙˆÙ†ÙŠØ©ØŒ ÙØ±Ø¯ÙŠØ©ØŒ Ø±Ù‚Ù…ÙŠØ©.</p>
      </div>
      <div style="margin-bottom: 1.25rem;"><label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: #e65100; font-size: 0.95rem;">ğŸ“ Ù‡Ù„ Ù‡Ù†Ø§Ùƒ Ø·Ø±ÙŠÙ‚Ø© Ù…Ø¹ÙŠÙ†Ø© (Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ© ØªØ¹Ù„ÙŠÙ…ÙŠØ© Ù…Ø­Ø¯Ø¯Ø©) ÙŠÙÙ‡Ù… Ù…Ù† Ø®Ù„Ø§Ù„Ù‡Ø§ Ø§Ø¨Ù†ØªÙƒÙ… Ø§Ù„Ø¯Ø±Ø³ØŸ Ø¥Ù† ÙˆØ¬Ø¯Øª Ø´Ø§Ø±ÙƒÙˆÙ†Ø§</label>
       <p style="font-size: 0.85rem; color: #8a6d3b; margin-bottom: 0.5rem; font-style: italic;">Ù…Ø«Ø§Ù„: Ø§Ù„ØªØ¹Ù„Ù… Ø¨Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹ØŒ Ø§Ù„ØªØ¹Ù„Ù… Ø§Ù„ØªØ¹Ø§ÙˆÙ†ÙŠØŒ Ø§Ù„ØªØ¹Ù„Ù… Ø§Ù„Ø°Ø§ØªÙŠ...</p><input type="text" id="parentLearningStrategy" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ© Ø§Ù„Ù…ÙØ¶Ù„Ø©..." style="width: 100%; padding: 10px; border: 1px solid #ffb74d; border-radius: 10px; background: white; color: #e65100;">
      </div>
      <div style="margin-bottom: 1rem;"><label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: #e65100; font-size: 0.95rem;">ğŸ“‹ ØªÙ… Ø§Ø³ØªØ¹Ø±Ø§Ø¶ Ø§Ù„Ø®Ø·Ø© Ø§Ù„Ø¹Ù„Ø§Ø¬ÙŠØ© ÙˆØ§Ù„Ø¥Ø«Ø±Ø§Ø¦ÙŠØ© Ø§Ù„ØªÙŠ Ù†ÙØ°ØªÙ‡Ø§ Ø§Ù„Ù…Ø¹ï¿½ï¿½Ù…Ø© Ù„Ø§Ø¨Ù†ØªÙƒÙ… ÙˆØ¸Ù‡Ø±Øª Ø§Ù„Ù†ØªØ§Ø¦Ø¬ØŒ Ù‡Ù„ Ù‡Ù†Ø§Ùƒ Ø·Ø±ÙŠÙ‚Ø© Ø£Ø®Ø±Ù‰ ØªØ±ØºØ¨ÙˆÙ† ÙÙŠ Ø¥Ø¶Ø§ÙØªÙ‡Ø§ Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù„Ø§Ø¨Ù†ØªÙƒÙ… Ø¬ÙˆØ§Ù†Ø¨ Ø¶Ø¹Ù Ù†Ø§Ù‚Ø´ØªÙ‡Ø§ Ù…Ø¹Ù„Ù…ØªÙ‡Ø§ Ù…Ø¹ÙƒÙ… Ù…Ø³Ø¨Ù‚Ø§Ù‹ØŸ</label> <select id="parentHasAdditionalMethod" style="width: 100%; padding: 10px; border: 1px solid #ffb74d; border-radius: 10px; background: white; color: #e65100;"> <option value="">Ø§Ø®ØªØ§Ø±ÙˆØ§ Ø¥Ø¬Ø§Ø¨Ø©...</option> <option value="Ù„Ø§">Ù„Ø§ØŒ Ù„Ø§ ÙŠÙˆØ¬Ø¯ (ï¿½ï¿½ï¿½ï¿½ÙƒØªÙÙŠ Ø¨Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ù…Ø¹Ù„Ù…Ø©)</option> <option value="Ù†Ø¹Ù…">Ù†Ø¹Ù… ÙŠÙˆØ¬Ø¯</option> </select>
      </div>
      <div id="parentAdditionalMethodContainer" style="margin-bottom: 1rem; display: none;"><label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: #e65100; font-size: 0.95rem;">âœï¸ Ø§ÙƒØªØ¨ÙˆØ§ Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ© Ø§Ù„ØªÙŠ ØªØ±ØºØ¨ÙˆÙ† ÙÙŠÙ‡Ø§</label> <textarea id="parentAdditionalMethod" placeholder="Ø´Ø§Ø±ÙƒÙˆÙ†Ø§ Ø£ÙÙƒØ§Ø±ÙƒÙ…..." style="width: 100%; min-height: 80px; padding: 10px; border: 1px solid #ffb74d; border-radius: 10px; background: white; color: #e65100; resize: vertical;"></textarea>
      </div>
     </div>
     <div class="card-soft" style="margin-top: 1rem; background: linear-gradient(135deg, #e1f5fe, #e8eaf6); border: 2px solid #64b5f6;">
      <h4 style="color: #1976d2; margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;"><span style="font-size: 1.3rem;">ğŸ“Š</span> <span>Ø§Ø³ØªØ¨ÙŠØ§Ù† Ø³Ø±ÙŠØ¹</span></h4>
      <div style="margin-bottom: 1.25rem;"><label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: #0d47a1; font-size: 0.95rem;">â“ Ù‡Ù„ ØªÙ‚ÙˆÙ… Ø§Ø¨Ù†ØªÙƒÙ… Ø¯Ø§Ø¦Ù…Ø§Ù‹ Ø¨Ø¥Ø®Ø¨Ø§Ø±ÙƒÙ… Ø¨ØªØ­ØµÙŠÙ„Ù‡Ø§ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ ÙÙŠ Ù…Ø§Ø¯Ø© Ø§Ù„ØªÙ‚Ù†ÙŠØ© Ø§Ù„Ø±Ù‚Ù…ÙŠØ©ØŸ</label> <select id="parentInformParent" style="width: 100%; padding: 10px; border: 1px solid #64b5f6; border-radius: 10px; background: white; color: #1976d2;"> <option value="">Ø§Ø®ØªØ§Ø±ÙˆØ§ Ø¥Ø¬Ø§Ø¨Ø©...</option> <option value="Ø¯Ø§Ø¦Ù…Ø§Ù‹">Ø¯Ø§Ø¦Ù…Ø§Ù‹ âœ…</option> <option value="ØºØ§Ù„Ø¨Ø§Ù‹">ØºØ§Ù„Ø¨Ø§Ù‹ ğŸ‘</option> <option value="Ø£Ø­ÙŠØ§Ù†Ø§Ù‹">Ø£Ø­ÙŠØ§Ù†Ø§Ù‹ ğŸ¤”</option> <option value="Ù†Ø§Ø¯Ø±Ø§Ù‹">Ù†Ø§Ø¯Ø±Ø§Ù‹ ğŸ˜</option> <option value="Ø£Ø¨Ø¯Ø§Ù‹">Ø£Ø¨Ø¯Ø§Ù‹ âŒ</option> </select>
      </div>
      <div style="margin-bottom: 1.25rem;"><label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: #0d47a1; font-size: 0.95rem;">â­ Ù…Ø§ Ù…Ø¯Ù‰ Ø±Ø¶Ø§ÙƒÙ… Ø¹Ù† Ø¢Ù„ÙŠØ© Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø© Ù‡Ø°Ù‡ØŸ</label> <select id="parentSatisfactionLevel" style="width: 100%; padding: 10px; border: 1px solid #64b5f6; border-radius: 10px; background: white; color: #1976d2;"> <option value="">Ø§Ø®ØªØ§Ø±ÙˆØ§ Ø¥Ø¬Ø§Ø¨Ø©...</option> <option value="ï¿½ï¿½Ø§Ø¶ÙˆÙ† Ø¬Ø¯Ø§Ù‹">Ø±Ø§Ø¶ï¿½ï¿½Ù† Ø¬Ø¯Ø§Ù‹ â­â­â­â­â­</option> <option value="Ø±Ø§Ø¶ÙˆÙ†">Ø±Ø§Ø¶ÙˆÙ† â­â­â­â­</option> <option value="Ù…Ø­Ø§ÙŠØ¯ÙˆÙ†">Ù…Ø­Ø§ÙŠØ¯ÙˆÙ† â­â­â­</option> <option value="ØºÙŠØ± Ø±Ø§Ø¶ÙŠÙ†">ØºÙŠØ± Ø±Ø§Ø¶ÙŠÙ† â­â­</option> <option value="ØºÙŠØ± Ø±Ø§Ø¶ÙŠÙ† ØªÙ…Ø§Ù…Ø§Ù‹">ØºÙŠØ± Ø±Ø§Ø¶ÙŠÙ† ØªÙ…Ø§Ù…Ø§Ù‹ â­</option> </select>
      </div><button id="submitParentSurvey" style="width: 100%; background: linear-gradient(90deg, #2196f3, #1976d2); color: white; padding: 12px; border-radius: 10px; font-weight: 700; font-size: 1rem;"> ğŸ“© Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø§Ø³ØªØ¨ÙŠØ§Ù† </button>
     </div>
     <div style="margin-top: 2rem; text-align: center; display: flex; gap: 10px; justify-content: center; flex-wrap: wrap;"><button onclick="contactTeacherWhatsAppParent()" style="background: linear-gradient(90deg, #25D366, #128C7E); border: none; color: white; padding: 10px 12px; border-radius: 10px; font-weight: 700; cursor: pointer;">ğŸ“² ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ù…Ø¹Ù„Ù…Ø©</button> <button class="ghost">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„ØªÙ‚Ø±ÙŠØ±</button>
     </div>
    </div>
   </section>
  </main><!-- Modal for all dialogs -->
  <div id="modalOverlay" class="modal-overlay">
   <div class="modal-content">
    <div class="modal-header">
     <h3 id="modalTitle">Ø¹Ù†ÙˆØ§Ù†</h3><button class="modal-close" onclick="closeModal()">ï¿½ï¿½</button>
    </div>
    <div class="modal-body" id="modalBody"><!-- Dynamic content -->
    </div>
    <div class="modal-footer" id="modalFooter"><button class="ghost" onclick="closeModal()">Ø¥ØºÙ„Ø§Ù‚</button>
    </div>
   </div>
  </div>
  <script>
    // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
    const TEACHER_PIN = "1234";
    window.contactTeacherWhatsAppParent = function() {
      const phoneNumber = "966XXXXXXXXX";
      const studentName = document.getElementById('pName').textContent;
      const message = `Ø§Ù„Ø³Ù„Ø§Ù… Ø¹Ù„ÙŠÙƒÙ… Ù…Ø¹Ù„Ù…ØªÙŠ Ø§Ù„ÙØ§Ø¶Ù„Ø© ğŸŒ¸\n\nÙ†Ø­Ù† Ø£ÙˆÙ„ÙŠØ§Ø¡ Ø£Ù…Ø± Ø§Ù„Ø·Ø§Ù„Ø¨Ø©: ${studentName}\nÙ†Ø±ØºØ¨ ÙÙŠ Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹Ùƒ Ø¨Ø®ØµÙˆØµ Ù…Ø§Ø¯Ø© Ø§Ù„ØªÙ‚Ù†ÙŠØ© Ø§Ù„Ø±Ù‚Ù…ÙŠØ©.\n\nØ´ÙƒØ±Ø§Ù‹ Ù„Ùƒ ğŸ’š`;
      const whatsappURL = `https://wa.me/${phoneNumber}?text=${encodeURIComponent(message)}`;
      window.open(whatsappURL, '_blank', 'noopener,noreferrer');
    };

    // Ø±Ø¨Ø· Ø§Ù„Ø£Ø²Ø±Ø§Ø±
    document.getElementById('showTeacher').addEventListener('click', function() {
      document.querySelectorAll('.login-card').forEach(c => c.classList.add('hidden'));
      document.getElementById('teacherLogin').classList.remove('hidden');
    });

    document.getElementById('showStudent').addEventListener('click', function() {
      document.querySelectorAll('.login-card').forEach(c => c.classList.add('hidden'));
      document.getElementById('studentLogin').classList.remove('hidden');
    });

    document.getElementById('showParent').addEventListener('click', function() {
      document.querySelectorAll('.login-card').forEach(c => c.classList.add('hidden'));
      document.getElementById('parentLogin').classList.remove('hidden');
    });

    // Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø¥ØºÙ„Ø§Ù‚
    document.getElementById('closeTeacher').addEventListener('click', function() {
      document.getElementById('teacherLogin').classList.add('hidden');
    });

    document.getElementById('closeStudent').addEventListener('click', function() {
      document.getElementById('studentLogin').classList.add('hidden');
    });

    document.getElementById('closeParent').addEventListener('click', function() {
      document.getElementById('parentLogin').classList.add('hidden');
    });

    // Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø¯Ø®ÙˆÙ„
    document.getElementById('teacherEnter').addEventListener('click', function() {
      const code = document.getElementById('teacherCode').value.trim();
      if (code !== TEACHER_PIN) {
        showModal('Ø®Ø·Ø£', '<p style="text-align: center; color: var(--danger);">Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ ØºÙŠØ± ØµØ­ÙŠØ­. Ø­Ø§ÙˆÙ„ÙŠ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.</p>');
        return;
      }
      document.getElementById('loginMenu').classList.add('hidden');
      document.getElementById('teacherPanel').classList.remove('hidden');
    });

    document.getElementById('studentEnter').addEventListener('click', function() {
      const name = document.getElementById('studentNameInput').value.trim();
      if (!name) {
        showModal('ØªÙ†Ø¨ÙŠÙ‡', '<p style="text-align: center;">ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø§Ø³Ù…</p>');
        return;
      }
      
      const student = studentsData.find(s => s.name === name);
      if (!student) {
        showModal('Ø®Ø·Ø£', '<p style="text-align: center;">ï¿½ï¿½Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ø·Ø§Ù„Ø¨Ø©. ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ø§Ø³Ù….</p>');
        return;
      }
      
      displayStudentReport(student);
      
      document.getElementById('loginMenu').classList.add('hidden');
      document.getElementById('studentPanel').classList.remove('hidden');
    });

    document.getElementById('parentEnter').addEventListener('click', function() {
      const name = document.getElementById('parentNameInput').value.trim();
      if (!name) {
        showModal('ØªÙ†Ø¨ÙŠÙ‡', '<p style="text-align: center;">ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨Ø©</p>');
        return;
      }
      
      const student = studentsData.find(s => s.name === name);
      if (!student) {
        showModal('Ø®Ø·Ø£', '<p style="text-align: center;">Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ø·Ø§Ù„ï¿½ï¿½Ø©. ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ø§Ø³Ù….</p>');
        return;
      }
      
      displayParentReport(student);
      
      document.getElementById('loginMenu').classList.add('hidden');
      document.getElementById('parentPanel').classList.remove('hidden');
    });

    // Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø¹ÙˆØ¯Ø©
    document.getElementById('backToMenu1').addEventListener('click', function() {
      document.getElementById('teacherPanel').classList.add('hidden');
      document.getElementById('loginMenu').classList.remove('hidden');
      document.querySelectorAll('.login-card').forEach(c => c.classList.add('hidden'));
    });

    document.getElementById('backToMenu2').addEventListener('click', function() {
      document.getElementById('studentPanel').classList.add('hidden');
      document.getElementById('loginMenu').classList.remove('hidden');
      document.querySelectorAll('.login-card').forEach(c => c.classList.add('hidden'));
    });

    document.getElementById('backToMenu3').addEventListener('click', function() {
      document.getElementById('parentPanel').classList.add('hidden');
      document.getElementById('loginMenu').classList.remove('hidden');
      document.querySelectorAll('.login-card').forEach(c => c.classList.add('hidden'));
    });

    // Ù…Ø¹Ø§Ù„Ø¬ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù†Ø³Ø¯Ù„Ø© Ù„Ù„Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ© - Ø§Ù„Ø·Ø§Ù„Ø¨Ø©
    document.getElementById('hasAdditionalMethod').addEventListener('change', function() {
      const container = document.getElementById('additionalMethodContainer');
      if (this.value === 'Ù†Ø¹Ù…') {
        container.style.display = 'block';
      } else {
        container.style.display = 'none';
      }
    });

    // Ù…Ø¹Ø§Ù„Ø¬ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù†Ø³Ø¯Ù„Ø© Ù„Ù„Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ© - ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø±
    document.getElementById('parentHasAdditionalMethod').addEventListener('change', function() {
      const container = document.getElementById('parentAdditionalMethodContainer');
      if (this.value === 'Ù†Ø¹Ù…') {
        container.style.display = 'block';
      } else {
        container.style.display = 'none';
      }
    });

    // Ù†Ø¸Ø§Ù… Modal
    function showModal(title, bodyHTML, footerHTML = '') {
      document.getElementById('modalTitle').textContent = title;
      document.getElementById('modalBody').innerHTML = bodyHTML;
      if (footerHTML) {
        document.getElementById('modalFooter').innerHTML = footerHTML;
      } else {
        document.getElementById('modalFooter').innerHTML = '<button class="ghost" onclick="closeModal()">Ø¥ØºÙ„Ø§Ù‚</button>';
      }
      document.getElementById('modalOverlay').classList.add('active');
    }

    function closeModal() {
      document.getElementById('modalOverlay').classList.remove('active');
    }

    // Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
    const STORAGE_KEY = "gradingData.v1";
    let studentsData = loadData();

    function loadData() {
      const raw = localStorage.getItem(STORAGE_KEY);
      if (!raw) return [];
      try {
        return JSON.parse(raw);
      } catch {
        return [];
      }
    }

    function saveData() {
      localStorage.setItem(STORAGE_KEY, JSON.stringify(studentsData));
      renderTable();
    }

    function renderTable() {
      const tbody = document.getElementById('gradesTableBody');
      tbody.innerHTML = '';

      if (studentsData.length === 0) {
        tbody.innerHTML = '<tr><td colspan="16" style="text-align: center; padding: 3rem 1rem; color: var(--muted);"><div style="font-size: 3rem;">ğŸ“š</div><p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ø§Ù„Ø¨Ø§Øª ï¿½ï¿½Ø¹Ø¯</p></td></tr>';
        updateStatistics();
        return;
      }

      studentsData.forEach((student, index) => {
        const total = (student.exams || 0) + (student.practical || 0) + (student.homework || 0) + (student.discussion || 0);
        const tr = document.createElement('tr');
        tr.style.background = '#fff';
        tr.innerHTML = `
          <td style="padding: 8px 6px; border-bottom: 1px solid #eef3f9; text-align: center;">${student.name}</td>
          <td style="padding: 8px 6px; border-bottom: 1px solid #eef3f9; text-align: center;">${student.class}</td>
          <td contenteditable="true" data-index="${index}" data-field="exams" style="padding: 8px 6px; border-bottom: 1px solid #eef3f9; text-align: center; cursor: text;">${student.exams || 0}</td>
          <td contenteditable="true" data-index="${index}" data-field="practical" style="padding: 8px 6px; border-bottom: 1px solid #eef3f9; text-align: center; cursor: text;">${student.practical || 0}</td>
          <td contenteditable="true" data-index="${index}" data-field="homework" style="padding: 8px 6px; border-bottom: 1px solid #eef3f9; text-align: center; cursor: text;">${student.homework || 0}</td>
          <td contenteditable="true" data-index="${index}" data-field="discussion" style="padding: 8px 6px; border-bottom: 1px solid #eef3f9; text-align: center; cursor: text;">${student.discussion || 0}</td>
          
          <td style="padding: 8px 6px; border-bottom: 1px solid #eef3f9; text-align: center;">
            <div style="display: flex; flex-direction: column; gap: 4px; align-items: center;">
              <select data-index="${index}" data-field="teamwork" style="padding: 4px 8px; border: 1px solid #dfe7f1; border-radius: 6px; background: white; font-size: 0.85rem; width: 100%;">
                <option value="">Ø§Ø®ØªØ±...</option>
                <option value="Ù…Ù…ØªØ§Ø²" ${student.teamwork === 'Ù…Ù…ØªØ§Ø²' ? 'selected' : ''}>Ù…Ù…ØªØ§Ø² â­</option>
                <option value="Ø¬ÙŠØ¯ Ø¬Ø¯Ø§Ù‹" ${student.teamwork === 'Ø¬ÙŠØ¯ Ø¬Ø¯Ø§Ù‹' ? 'selected' : ''}>Ø¬ÙŠØ¯ Ø¬Ø¯Ø§Ù‹ ğŸ‘</option>
                <option value="Ø¬ÙŠØ¯" ${student.teamwork === 'Ø¬ÙŠØ¯' ? 'selected' : ''}>Ø¬ÙŠØ¯ âœ…</option>
                <option value="Ù…Ù‚Ø¨ÙˆÙ„" ${student.teamwork === 'Ù…Ù‚Ø¨ÙˆÙ„' ? 'selected' : ''}>Ù…Ù‚Ø¨ÙˆÙ„ ğŸ‘Œ</option>
                <option value="Ø¶Ø¹ÙŠÙ" ${student.teamwork === 'Ø¶Ø¹ÙŠÙ' ? 'selected' : ''}>Ø¶Ø¹ÙŠÙ âš ï¸</option>
              </select>
              <button onclick="addTeamworkNote(${index})" style="padding: 3px 6px; font-size: 0.75rem; background: #e3f2fd; color: #1976d2; border: 1px solid #90caf9; border-radius: 4px; cursor: pointer; white-space: nowrap;">ğŸ“ Ù…Ù„Ø§Ø­Ø¸Ø©</button>
            </div>
          </td>
          
          <td style="padding: 8px 6px; border-bottom: 1px solid #eef3f9; text-align: center;">
            <div style="display: flex; flex-direction: column; gap: 4px; align-items: center;">
              <textarea data-index="${index}" data-field="excellence" placeholder="Ø§ÙƒØªØ¨ Ù†Ù‚Ø§Ø· Ø§Ù„ØªÙ…ÙŠØ²..." style="padding: 6px; border: 1px solid #dfe7f1; border-radius: 6px; font-size: 0.85rem; width: 100%; min-height: 50px; resize: vertical;">${student.excellence || ''}</textarea>
              <button onclick="suggestExcellence(${index})" style="padding: 3px 6px; font-size: 0.75rem; background: #fff3e0; color: #e65100; border: 1px solid #ffb74d; border-radius: 4px; cursor: pointer;">ğŸ’¡ Ø§Ù‚ØªØ±Ø§Ø­</button>
            </div>
          </td>
          
          <td style="padding: 8px 6px; border-bottom: 1px solid #eef3f9; text-align: center;">
            <div style="display: flex; flex-direction: column; gap: 4px; align-items: center;">
              <textarea data-index="${index}" data-field="strengths" placeholder="Ø§ÙƒØªØ¨ Ù†Ù‚Ø§Ø· Ø§Ù„Ù‚ÙˆØ©..." style="padding: 6px; border: 1px solid #dfe7f1; border-radius: 6px; font-size: 0.85rem; width: 100%; min-height: 50px; resize: vertical;">${student.strengths || ''}</textarea>
              <button onclick="suggestStrengths(${index})" style="padding: 3px 6px; font-size: 0.75rem; background: #e8f5e9; color: #2e7d32; border: 1px solid #81c784; border-radius: 4px; cursor: pointer;">ğŸ’ª Ø§Ù‚ØªØ±Ø§Ø­</button>
            </div>
          </td>
          
          <td style="padding: 8px 6px; border-bottom: 1px solid #eef3f9; text-align: center;">
            <div style="display: flex; flex-direction: column; gap: 4px; align-items: center;">
              <textarea data-index="${index}" data-field="weaknesses" placeholder="Ø§ÙƒØªØ¨ Ù†Ù‚Ø§Ø· Ø§Ù„Ø¶Ø¹Ù..." style="padding: 6px; border: 1px solid #dfe7f1; border-radius: 6px; font-size: 0.85rem; width: 100%; min-height: 50px; resize: vertical;">${student.weaknesses || ''}</textarea>
              <button onclick="suggestWeaknesses(${index})" style="padding: 3px 6px; font-size: 0.75rem; background: #ffebee; color: #c62828; border: 1px solid #ef5350; border-radius: 4px; cursor: pointer;">ğŸ“‹ Ø§Ù‚ØªØ±Ø§Ø­</button>
            </div>
          </td>
          
          <td style="padding: 8px 6px; border-bottom: 1px solid #eef3f9; text-align: center;">
            <div style="display: flex; flex-direction: column; gap: 4px; align-items: center;">
              <strong style="font-size: 1.1rem; color: ${total >= 90 ? '#2e7d32' : total >= 75 ? '#1976d2' : total >= 60 ? '#f57c00' : '#d32f2f'};">${total}</strong>
              <div style="width: 100%; height: 6px; background: #e0e0e0; border-radius: 3px; overflow: hidden;">
                <div style="height: 100%; background: ${total >= 90 ? '#4caf50' : total >= 75 ? '#2196f3' : total >= 60 ? '#ff9800' : '#f44336'}; width: ${total}%; transition: width 0.3s;"></div>
              </div>
            </div>
          </td>
          
          <td style="padding: 8px 6px; border-bottom: 1px solid #eef3f9; text-align: center;">
            <div style="display: flex; flex-direction: column; gap: 4px; align-items: center;">
              <textarea data-index="${index}" data-field="improvementPlan" placeholder="Ø®Ø·Ø© Ø§Ù„ØªØ­Ø³ÙŠÙ†..." style="padding: 6px; border: 1px solid #dfe7f1; border-radius: 6px; font-size: 0.85rem; width: 100%; min-height: 50px; resize: vertical;">${student.improvementPlan || ''}</textarea>
              <div style="display: flex; gap: 4px; width: 100%;">
                <button onclick="generatePlan(${index})" style="padding: 3px 6px; font-size: 0.75rem; background: #f3e5f5; color: #7b1fa2; border: 1px solid #ba68c8; border-radius: 4px; cursor: pointer; flex: 1;">ğŸ¤– ØªÙˆÙ„ÙŠØ¯</button>
                <button onclick="viewPlanHistory(${index})" style="padding: 3px 6px; font-size: 0.75rem; background: #e1f5fe; color: #0277bd; border: 1px solid #4fc3f7; border-radius: 4px; cursor: pointer; flex: 1;">ğŸ“œ Ø³Ø¬Ù„</button>
              </div>
            </div>
          </td>
          
          <td style="padding: 8px 6px; border-bottom: 1px solid #eef3f9; text-align: center;">
            <div style="display: flex; flex-direction: column; gap: 4px; align-items: center;">
              <select data-index="${index}" data-field="studentStatus" style="padding: 4px 8px; border: 1px solid #dfe7f1; border-radius: 6px; background: white; font-size: 0.85rem; width: 100%;">
                <option value="">Ø§Ø®ØªØ±...</option>
                <option value="Ù…ØªÙÙˆÙ‚Ø©" ${student.studentStatus === 'Ù…ØªÙÙˆÙ‚Ø©' ? 'selected' : ''}>Ù…ØªÙÙˆÙ‚Ø© ğŸ†</option>
                <option value="Ø¬ÙŠØ¯Ø©" ${student.studentStatus === 'Ø¬ÙŠØ¯Ø©' ? 'selected' : ''}>Ø¬ÙŠØ¯Ø© âœ¨</option>
                <option value="Ù…ØªÙˆØ³Ø·Ø©" ${student.studentStatus === 'Ù…ØªÙˆØ³Ø·Ø©' ? 'selected' : ''}>Ù…ØªÙˆØ³Ø·Ø© ğŸ“Š</option>
                <option value="ØªØ­ØªØ§Ø¬ Ø¯Ø¹Ù…" ${student.studentStatus === 'ØªØ­ØªØ§Ø¬ Ø¯Ø¹Ù…' ? 'selected' : ''}>ØªØ­ØªØ§Ø¬ Ø¯Ø¹Ù… ğŸ†˜</option>
              </select>
              <button onclick="analyzeStatus(${index})" style="padding: 3px 6px; font-size: 0.75rem; background: #fce4ec; color: #c2185b; border: 1px solid #f48fb1; border-radius: 4px; cursor: pointer; white-space: nowrap;">ğŸ“Š ØªØ­Ù„ÙŠÙ„</button>
            </div>
          </td>
          
          <td style="padding: 8px 6px; border-bottom: 1px solid #eef3f9; text-align: center;">
            <div style="display: flex; flex-direction: column; gap: 4px; align-items: center;">
              <select data-index="${index}" data-field="parentContact" style="padding: 4px 8px; border: 1px solid #dfe7f1; border-radius: 6px; background: white; font-size: 0.85rem; width: 100%;">
                <option value="Ù„Ø§" ${student.parentContact === 'Ù„Ø§' ? 'selected' : ''}>ï¿½ï¿½Ø§ âŒ</option>
                <option value="ï¿½ï¿½Ø¹Ù…" ${student.parentContact === 'Ù†Ø¹Ù…' ? 'selected' : ''}>Ù†Ø¹Ù… âœ…</option>
              </select>
              <div style="display: flex; gap: 4px; width: 100%;">
                <button onclick="logContact(${index})" style="padding: 3px 6px; font-size: 0.75rem; background: #e8f5e9; color: #2e7d32; border: 1px solid #81c784; border-radius: 4px; cursor: pointer; flex: 1;">ğŸ“ ØªØ³Ø¬ÙŠÙ„</button>
                <button onclick="viewContactHistory(${index})" style="padding: 3px 6px; font-size: 0.75rem; background: #fff3e0; color: #e65100; border: 1px solid #ffb74d; border-radius: 4px; cursor: pointer; flex: 1;">ğŸ“‹ Ø³Ø¬Ù„</button>
              </div>
            </div>
          </td>
          
          <td contenteditable="true" data-index="${index}" data-field="attendance" style="padding: 8px 6px; border-bottom: 1px solid #eef3f9; text-align: center; cursor: text;">${student.attendance || 0}</td>
          <td style="padding: 8px 6px; border-bottom: 1px solid #eef3f9; text-align: center;">
            <button class="danger" onclick="deleteStudent(${index})" style="padding: 4px 8px; font-size: 0.85rem;">ğŸ—‘ï¸</button>
          </td>
        `;
        tbody.appendChild(tr);
      });

      // ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ø¨Ø§Ø´Ø± Ù„Ù„Ø£Ø±Ù‚Ø§Ù…
      document.querySelectorAll('td[contenteditable="true"]').forEach(td => {
        td.addEventListener('blur', function() {
          const index = parseInt(this.dataset.index);
          const field = this.dataset.field;
          
          if (['exams', 'practical', 'homework', 'discussion', 'attendance'].includes(field)) {
            const value = parseInt(this.textContent) || 0;
            const maxValues = { exams: 20, practical: 30, homework: 30, discussion: 20, attendance: 100 };
            const finalValue = Math.max(0, Math.min(maxValues[field] || 100, value));
            this.textContent = finalValue;
            studentsData[index][field] = finalValue;
          } else {
            studentsData[index][field] = this.textContent.trim();
          }
          saveData();
        });
      });

      // ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ù„Ù„Ù€ textarea
      document.querySelectorAll('textarea[data-index]').forEach(textarea => {
        textarea.addEventListener('blur', function() {
          const index = parseInt(this.dataset.index);
          const field = this.dataset.field;
          studentsData[index][field] = this.value.trim();
          saveData();
        });
      });

      // ØªÙØ¹ÙŠÙ„ Ø§Ù„Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ù…Ù†Ø³Ø¯Ù„Ø©
      document.querySelectorAll('select[data-index]').forEach(select => {
        select.addEventListener('change', function() {
          const index = parseInt(this.dataset.index);
          const field = this.dataset.field;
          studentsData[index][field] = this.value;
          saveData();
        });
      });

      updateStatistics();
    }
    
    function updateStatistics() {
      const totalStudents = studentsData.length;
      
      if (totalStudents === 0) {
        document.getElementById('countStudents').textContent = '0';
        document.getElementById('classAvg').textContent = '0';
        document.getElementById('attendanceRate').textContent = '0%';
        document.getElementById('overduePlans').textContent = '0';
        document.getElementById('dueSoonPlans').textContent = '0';
        document.getElementById('dueTodayPlans').textContent = '0';
        return;
      }
      
      const avgTotal = studentsData.reduce((sum, s) => sum + ((s.exams || 0) + (s.practical || 0) + (s.homework || 0) + (s.discussion || 0)), 0) / totalStudents;
      const totalAttendanceDays = studentsData.reduce((sum, s) => sum + (s.attendance || 0), 0);
      const avgAttendance = totalAttendanceDays / totalStudents;
      const attendanceRate = ((avgAttendance / 100) * 100).toFixed(0);
      
      document.getElementById('countStudents').textContent = totalStudents;
      document.getElementById('classAvg').textContent = avgTotal.toFixed(1);
      document.getElementById('attendanceRate').textContent = attendanceRate + '%';
      
      // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø®Ø·Ø· (Ø§ÙØªØ±Ø§Ø¶ÙŠØ§Ù‹ 0 Ø­ØªÙ‰ ÙŠØªÙ… Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ù…Ù„Ù Ø§Ù„Ø®Ø·Ø·)
      document.getElementById('overduePlans').textContent = '0';
      document.getElementById('dueSoonPlans').textContent = '0';
      document.getElementById('dueTodayPlans').textContent = '0';
    }

    // ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ø£Ø¹Ù…Ø¯Ø© Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©
    window.addTeamworkNote = function(index) {
      const student = studentsData[index];
      showModal('Ù…Ù„Ø§Ø­Ø¸Ø© Ø§Ù„ØªØ¹Ø§ÙˆÙ† Ù…Ø¹ Ø§Ù„Ù…Ø¬ï¿½ï¿½ÙˆØ¹Ø©', `
        <div style="margin-bottom: 1.5rem;">
          <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--brand);">Ø§Ù„Ø·Ø§Ù„Ø¨Ø©:</label>
          <div style="padding: 0.75rem; background: #f5f9fc; border-radius: 8px; font-weight: 700; font-size: 1.05rem; color: var(--text);">
            ${student.name}
          </div>
        </div>
        
        <div style="margin-bottom: 1rem;">
          <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text);">Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø©:</label>
          <textarea id="teamworkNoteText" placeholder="Ø§ÙƒØªØ¨ Ù…Ù„Ø§Ø­Ø¸Ø© Ø¹Ù† ØªØ¹Ø§ÙˆÙ† Ø§Ù„Ø·Ø§Ù„Ø¨Ø© Ù…Ø¹ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø©..." style="width: 100%; min-height: 120px; padding: 12px; border: 1px solid #dfe7f1; border-radius: 10px; font-size: 1rem; resize: vertical;">${student.teamworkNote || ''}</textarea>
        </div>
      `, `
        <button onclick="saveTeamworkNote(${index})">ğŸ’¾ Ø­ÙØ¸</button>
        <button class="ghost" onclick="closeModal()">Ø¥Ù„ØºØ§Ø¡</button>
      `);
    };
    
    window.saveTeamworkNote = function(index) {
      const noteText = document.getElementById('teamworkNoteText').value.trim();
      studentsData[index].teamworkNote = noteText;
      saveData();
      closeModal();
      showModal('ØªÙ… Ø§Ù„Ø­ÙØ¸', '<p style="text-align: center; color: #2e7d32;">âœ… ØªÙ… Ø­ÙØ¸ Ù…Ù„Ø§Ø­Ø¸Ø© Ø§Ù„ØªØ¹Ø§ÙˆÙ† Ø¨Ù†Ø¬Ø§Ø­</p>');
      setTimeout(closeModal, 1500);
    };

    window.suggestExcellence = function(index) {
      const student = studentsData[index];
      const suggestions = [
        'ØªÙ…ÙŠØ² ÙÙŠ Ø­Ù„ Ø§Ù„Ù…Ø´ÙƒÙ„Ø§Øª Ø¨Ø·Ø±Ù‚ Ø¥Ø¨Ø¯Ø§Ø¹ÙŠØ©',
        'ØªÙ…ØªÙ„Ùƒ Ù…Ù‡Ø§Ø±Ø© ØªÙ‚Ø¯ÙŠÙ… Ø§Ù„Ø£ÙÙƒØ§Ø± Ø¨ÙˆØ¶ÙˆØ­',
        'ØªØ¸Ù‡Ø± Ù‚ÙŠØ§Ø¯Ø© ÙˆØ§Ø¶Ø­Ø© ÙÙŠ Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹ Ø§Ù„Ø¬Ù…Ø§Ø¹ÙŠØ©',
        'ØªØ¨Ø¯ÙŠ Ø§Ù‡ØªÙ…Ø§Ù…Ø§Ù‹ ÙˆØ§Ø¶Ø­Ø§Ù‹ Ø¨Ø§Ù„ØªÙï¿½ï¿½ØµÙŠÙ„ Ø§Ù„Ø¯Ù‚ÙŠÙ‚Ø©',
        'ØªØªÙ…ØªØ¹ Ø¨Ø³Ø±Ø¹Ø© Ø§Ø³ØªÙŠØ¹Ø§Ø¨ Ø§Ù„Ù…ÙØ§Ù‡ÙŠÙ… Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©'
      ];
      
      const currentPoints = (student.excellence || '').split('â€¢').filter(p => p.trim()).map(p => p.trim());
      
      showModal('Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª Ù„Ù†Ù‚Ø§Ø· Ø§Ù„ØªÙ…ÙŠØ²', `
        <div style="margin-bottom: 1.5rem;">
          <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--brand);">Ø§Ù„Ø·Ø§Ù„Ø¨Ø©:</label>
          <div style="padding: 0.75rem; background: #f5f9fc; border-radius: 8px; font-weight: 700; font-size: 1.05rem; color: var(--text);">
            ${student.name}
          </div>
        </div>
        
        <div style="margin-bottom: 1.5rem;">
          <label style="display: block; margin-bottom: 0.75rem; font-weight: 600; color: var(--text);">Ø§Ø®ØªØ± Ù†Ù‚Ø§Ø· Ø§ï¿½ï¿½ØªÙ…ÙŠØ² (ÙŠÙ…ÙƒÙ† Ø§Ø®ØªÙŠØ§Ø± Ø£ÙƒØ«Ø± Ù…Ù† Ù†Ù‚Ø·Ø©):</label>
          <div id="excellenceSuggestions" style="display: flex; flex-direction: column; gap: 0.5rem;">
            ${suggestions.map((sug, i) => `
              <label style="display: flex; align-items: start; gap: 0.5rem; padding: 0.75rem; background: #fff3e0; border: 2px solid #ffe0b2; border-radius: 8px; cursor: pointer; transition: all 0.2s;">
                <input type="checkbox" id="excellence_${i}" value="${sug}" style="margin-top: 0.25rem; width: 18px; height: 18px; cursor: pointer;">
                <span style="flex: 1; line-height: 1.5;">âœ¨ ${sug}</span>
              </label>
            `).join('')}
          </div>
        </div>
        
        <div style="margin-bottom: 1rem;">
          <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text);">Ø£Ùˆ Ø§ÙƒØªØ¨ Ù†Ù‚Ø·Ø© ØªÙ…ÙŠØ² Ø¬Ø¯ÙŠØ¯Ø©:</label>
          <textarea id="customExcellence" placeholder="Ø§ÙƒØªï¿½ï¿½ Ù†Ù‚Ø·Ø© ØªÙ…ÙŠØ² Ù…Ø®ØµØµØ©..." style="width: 100%; min-height: 80px; padding: 12px; border: 1px solid #dfe7f1; border-radius: 10px; font-size: 1rem; resize: vertical;"></textarea>
        </div>
        
        ${currentPoints.length > 0 ? `
          <div style="background: #e8f5e9; padding: 1rem; border-radius: 8px; margin-bottom: 1rem; border: 2px solid #81c784;">
            <p style="font-weight: 600; color: #2e7d32; margin-bottom: 0.5rem; font-size: 0.9rem;">ğŸ“‹ Ø§Ù„Ù†Ù‚Ø§Ø· Ø§Ù„Ù…Ø¶Ø§ÙØ© Ø­Ø§Ù„ÙŠØ§Ù‹:</p>
            <div style="font-size: 0.9rem; line-height: 1.8; color: var(--text);">
              ${currentPoints.map(p => `â€¢ ${p}`).join('<br>')}
            </div>
          </div>
        ` : ''}
      `, `
        <button onclick="saveExcellenceSuggestions(${index})">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„Ù†Ù‚Ø§Ø·</button>
        <button class="ghost" onclick="closeModal()">Ø¥Ù„ØºØ§Ø¡</button>
      `);
    };
    
    window.saveExcellenceSuggestions = function(index) {
      const selectedPoints = [];
      
      document.querySelectorAll('#excellenceSuggestions input[type="checkbox"]:checked').forEach(checkbox => {
        selectedPoints.push(checkbox.value);
      });
      
      const customPoint = document.getElementById('customExcellence').value.trim();
      if (customPoint) {
        selectedPoints.push(customPoint);
      }
      
      if (selectedPoints.length === 0) {
        showModal('ØªÙ†Ø¨ÙŠÙ‡', '<p style="text-align: center;">ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù†Ù‚Ø·Ø© ØªÙ…ÙŠØ² ÙˆØ§Ø­Ø¯Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„ Ø£Ùˆ ÙƒØªï¿½ï¿½Ø¨Ø© Ù†Ù‚Ø·Ø© Ù…Ø®ØµØµØ©</p>');
        return;
      }
      
      const currentPoints = (studentsData[index].excellence || '').split('â€¢').filter(p => p.trim()).map(p => p.trim());
      const allPoints = [...new Set([...currentPoints, ...selectedPoints])];
      
      studentsData[index].excellence = allPoints.map(p => `â€¢ ${p}`).join('\n');
      saveData();
      closeModal();
      showModal('ØªÙ… Ø§Ù„Ø­ÙØ¸', '<p style="text-align: center; color: #2e7d32;">âœ… ØªÙ… Ø¥Ø¶Ø§ÙØ© Ù†Ù‚Ø§Ø· Ø§Ù„ØªÙ…ÙŠØ² Ø¨Ù†Ø¬Ø§Ø­</p>');
      setTimeout(closeModal, 1500);
    };

    window.suggestStrengths = function(index) {
      const student = studentsData[index];
      const suggestions = [
        'Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… Ø¨Ø§Ù„Ù…ÙˆØ§Ø¹ÙŠØ¯ ÙˆØ§Ù„Ø§Ù†Ø¶Ø¨Ø§Ø·',
        'Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„ÙØ¹Ø§Ù„Ø© ÙÙŠ Ø§Ù„Ù†Ù‚Ø§Ø´Ø§Øª',
        'Ø¥ØªÙ‚Ø§Ù† Ø§Ù„Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„Ø¹Ù…Ù„ÙŠØ©',
        'Ø§Ù„ØªÙØ§Ø¹Ù„ Ø§Ù„Ø¥ÙŠØ¬Ø§Ø¨ÙŠ Ù…Ø¹ Ø§Ù„Ø²Ù…ÙŠÙ„Ø§Øª',
        'Ø§Ù„Ù‚Ø¯Ø±Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ Ù…Ø³ï¿½ï¿½Ù‚Ù„'
      ];
      
      const currentPoints = (student.strengths || '').split('ï¿½ï¿½ï¿½').filter(p => p.trim()).map(p => p.trim());
      
      showModal('Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª Ù„Ù†Ù‚Ø§Ø· Ø§Ù„Ù‚ÙˆØ©', `
        <div style="margin-bottom: 1.5rem;">
          <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--brand);">Ø§Ù„Ø·Ø§ï¿½ï¿½Ø¨Ø©:</label>
          <div style="padding: 0.75rem; background: #f5f9fc; border-radius: 8px; font-weight: 700; font-size: 1.05rem; color: var(--text);">
            ${student.name}
          </div>
        </div>
        
        <div style="margin-bottom: 1.5rem;">
          <label style="display: block; margin-bottom: 0.75rem; font-weight: 600; color: var(--text);">Ø§Ø®ØªØ± Ù†Ù‚Ø§Ø· Ø§Ù„Ù‚ÙˆØ© (ÙŠÙ…ÙƒÙ† Ø§Ø®ØªÙŠØ§Ø± Ø£ÙƒØ«Ø± Ù…Ù† Ù†Ù‚Ø·Ø©):</label>
          <div id="strengthsSuggestions" style="display: flex; flex-direction: column; gap: 0.5rem;">
            ${suggestions.map((sug, i) => `
              <label style="display: flex; align-items: start; gap: 0.5rem; padding: 0.75rem; background: #e8f5e9; border: 2px solid #c8e6c9; border-radius: 8px; cursor: pointer; transition: all 0.2s;">
                <input type="checkbox" id="strength_${i}" value="${sug}" style="margin-top: 0.25rem; width: 18px; height: 18px; cursor: pointer;">
                <span style="flex: 1; line-height: 1.5;">ğŸ’ª ${sug}</span>
              </label>
            `).join('')}
          </div>
        </div>
        
        <div style="margin-bottom: 1rem;">
          <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text);">Ø£Ùˆ Ø§ÙƒØªØ¨ Ù†Ù‚Ø·Ø© Ù‚ÙˆØ© Ø¬Ø¯ÙŠØ¯Ø©:</label>
          <textarea id="customStrength" placeholder="Ø§ÙƒØªØ¨ Ù†Ù‚Ø·Ø© Ù‚ÙˆØ© Ù…Ø®ØµØµØ©..." style="width: 100%; min-height: 80px; padding: 12px; border: 1px solid #dfe7f1; border-radius: 10px; font-size: 1rem; resize: vertical;"></textarea>
        </div>
        
        ${currentPoints.length > 0 ? `
          <div style="background: #e3f2fd; padding: 1rem; border-radius: 8px; margin-bottom: 1rem; border: 2px solid #90caf9;">
            <p style="font-weight: 600; color: #1976d2; margin-bottom: 0.5rem; font-size: 0.9rem;">ğŸ“‹ Ø§Ù„Ù†Ù‚Ø§Ø· Ø§Ù„Ù…Ø¶Ø§ÙØ© Ø­Ø§Ù„ÙŠØ§Ù‹:</p>
            <div style="font-size: 0.9rem; line-height: 1.8; color: var(--text);">
              ${currentPoints.map(p => `â€¢ ${p}`).join('<br>')}
            </div>
          </div>
        ` : ''}
      `, `
        <button onclick="saveStrengthsSuggestions(${index})">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„Ù†Ù‚Ø§Ø·</button>
        <button class="ghost" onclick="closeModal()">Ø¥Ù„ØºØ§Ø¡</button>
      `);
    };
    
    window.saveStrengthsSuggestions = function(index) {
      const selectedPoints = [];
      
      document.querySelectorAll('#strengthsSuggestions input[type="checkbox"]:checked').forEach(checkbox => {
        selectedPoints.push(checkbox.value);
      });
      
      const customPoint = document.getElementById('customStrength').value.trim();
      if (customPoint) {
        selectedPoints.push(customPoint);
      }
      
      if (selectedPoints.length === 0) {
        showModal('ØªÙ†Ø¨ÙŠÙ‡', '<p style="text-align: center;">ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù†Ù‚Ø·Ø© Ù‚ÙˆØ© ÙˆØ§Ø­Ø¯Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„ Ø£Ùˆ ÙƒØªØ§Ø¨Ø© Ù†Ù‚Ø·Ø© Ù…Ø®ØµØµØ©</p>');
        return;
      }
      
      const currentPoints = (studentsData[index].strengths || '').split('â€¢').filter(p => p.trim()).map(p => p.trim());
      const allPoints = [...new Set([...currentPoints, ...selectedPoints])];
      
      studentsData[index].strengths = allPoints.map(p => `â€¢ ${p}`).join('\n');
      saveData();
      closeModal();
      showModal('ØªÙ… Ø§Ù„ï¿½ï¿½ÙØ¸', '<p style="text-align: center; color: #2e7d32;">âœ… ØªÙ… Ø¥Ø¶Ø§ÙØ© Ù†Ù‚Ø§Ø· Ø§Ù„Ù‚ÙˆØ© Ø¨Ù†Ø¬Ø§Ø­</p>');
      setTimeout(closeModal, 1500);
    };

    window.suggestWeaknesses = function(index) {
      const student = studentsData[index];
      const suggestions = [
        'ØªØ­ØªØ§Ø¬ Ù„ØªØ­Ø³ÙŠÙ† Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© ÙÙŠ Ø§Ù„ØµÙ',
        'ØªØ­ØªØ§Ø¬ Ù„ØªÙ‚ÙˆÙŠØ© Ù…Ù‡Ø§Ø±Ø§Øª Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ÙˆÙ‚Øª',
        'ØªØ­ØªØ§Ø¬ Ù„ØªØ·ÙˆÙŠØ± Ù…Ù‡Ø§Ø±Ø© Ø§Ù„ØªÙÙƒÙŠØ± Ø§Ù„Ù†Ù‚Ø¯ÙŠ',
        'ØªØ­ØªØ§Ø¬ Ù„ØªØ­Ø³ÙŠÙ† Ø£Ø³Ù„ÙˆØ¨ ØªÙ†Ø¸ÙŠÙ… Ø§Ù„Ø£ÙÙƒØ§Ø±',
        'ØªØ­ØªØ§Ø¬ Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„Ø«Ù‚Ø© Ø¹Ù†Ø¯ Ø§Ù„ØªÙ‚Ø¯ÙŠÙ…'
      ];
      
      const currentPoints = (student.weaknesses || '').split('â€¢').filter(p => p.trim()).map(p => p.trim());
      
      showModal('Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª Ù„Ù†Ù‚Ø§Ø· Ø§Ù„Ø¶Ø¹Ù', `
        <div style="margin-bottom: 1.5rem;">
          <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--brand);">Ø§Ù„Ø·Ø§Ù„Ø¨Ø©:</label>
          <div style="padding: 0.75rem; background: #f5f9fc; border-radius: 8px; font-weight: 700; font-size: 1.05rem; color: var(--text);">
            ${student.name}
          </div>
        </div>
        
        <div style="margin-bottom: 1.5rem;">
          <label style="display: block; margin-bottom: 0.75rem; font-weight: 600; color: var(--text);">Ø§Ø®ØªØ± Ù†Ù‚Ø§Ø· Ø§Ù„Ø¶Ø¹Ù (ÙŠÙ…ÙƒÙ† Ø§Ø®ØªÙŠØ§Ø± Ø£ÙƒØ«Ø± Ù…Ù† Ù†Ù‚Ø·Ø©):</label>
          <div id="weaknessesSuggestions" style="display: flex; flex-direction: column; gap: 0.5rem;">
            ${suggestions.map((sug, i) => `
              <label style="display: flex; align-items: start; gap: 0.5rem; padding: 0.75rem; background: #ffebee; border: 2px solid #ffcdd2; border-radius: 8px; cursor: pointer; transition: all 0.2s;">
                <input type="checkbox" id="weakness_${i}" value="${sug}" style="margin-top: 0.25rem; width: 18px; height: 18px; cursor: pointer;">
                <span style="flex: 1; line-height: 1.5;">ğŸ“‹ ${sug}</span>
              </label>
            `).join('')}
          </div>
        </div>
        
        <div style="margin-bottom: 1rem;">
          <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text);">Ø£Ùˆ Ø§ÙƒØªØ¨ Ù†Ù‚Ø·Ø© Ø¶Ø¹Ù Ø¬Ø¯ÙŠØ¯Ø©:</label>
          <textarea id="customWeakness" placeholder="Ø§ÙƒØªØ¨ Ù†Ù‚Ø·Ø© Ø¶Ø¹Ù Ù…Ø®ØµØµØ©..." style="width: 100%; min-height: 80px; padding: 12px; border: 1px solid #dfe7f1; border-radius: 10px; font-size: 1rem; resize: vertical;"></textarea>
        </div>
        
        ${currentPoints.length > 0 ? `
          <div style="background: #fff3e0; padding: 1rem; border-radius: 8px; margin-bottom: 1rem; border: 2px solid #ffb74d;">
            <p style="font-weight: 600; color: #e65100; margin-bottom: 0.5rem; font-size: 0.9rem;">ğŸ“‹ Ø§Ù„Ù†Ù‚Ø§Ø· Ø§Ù„Ù…Ø¶Ø§ÙØ© Ø­Ø§Ù„ÙŠØ§Ù‹:</p>
            <div style="font-size: 0.9rem; line-height: 1.8; color: var(--text);">
              ${currentPoints.map(p => `â€¢ ${p}`).join('<br>')}
            </div>
          </div>
        ` : ''}
      `, `
        <button onclick="saveWeaknessesSuggestions(${index})">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„ï¿½ï¿½Ù‚Ø§Ø·</button>
        <button class="ghost" onclick="closeModal()">Ø¥Ù„ØºØ§Ø¡</button>
      `);
    };
    
    window.saveWeaknessesSuggestions = function(index) {
      const selectedPoints = [];
      
      document.querySelectorAll('#weaknessesSuggestions input[type="checkbox"]:checked').forEach(checkbox => {
        selectedPoints.push(checkbox.value);
      });
      
      const customPoint = document.getElementById('customWeakness').value.trim();
      if (customPoint) {
        selectedPoints.push(customPoint);
      }
      
      if (selectedPoints.length === 0) {
        showModal('ØªÙ†Ø¨ÙŠÙ‡', '<p style="text-align: center;">ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù†Ù‚Ø·Ø© Ø¶Ø¹Ù ÙˆØ§Ø­Ø¯Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„ Ø£Ùˆ ÙƒØªØ§Ø¨Ø© Ù†Ù‚Ø·Ø© Ù…Ø®ØµØµØ©</p>');
        return;
      }
      
      const currentPoints = (studentsData[index].weaknesses || '').split('â€¢').filter(p => p.trim()).map(p => p.trim());
      const allPoints = [...new Set([...currentPoints, ...selectedPoints])];
      
      studentsData[index].weaknesses = allPoints.map(p => `â€¢ ${p}`).join('\n');
      saveData();
      closeModal();
      showModal('ØªÙ… Ø§Ù„Ø­ÙØ¸', '<p style="text-align: center; color: #2e7d32;">âœ… ØªÙ… Ø¥Ø¶Ø§ÙØ© Ù†Ù‚Ø§Ø· Ø§Ù„Ø¶Ø¹Ù Ø¨Ù†Ø¬Ø§Ø­</p>');
      setTimeout(closeModal, 1500);
    };

    window.generatePlan = function(index) {
      const student = studentsData[index];
      const total = (student.exams || 0) + (student.practical || 0) + (student.homework || 0) + (student.discussion || 0);
      const attendance = student.attendance || 0;
      const attendanceRate = (attendance / 100) * 100;
      
      // ØªØ­Ù„ÙŠÙ„ Ù†Ù‚Ø§Ø· Ø§Ù„Ù‚ÙˆØ© ÙˆØ§Ù„Ø¶Ø¹Ù
      const hasStrengths = student.strengths && student.strengths.trim();
      const hasWeaknesses = student.weaknesses && student.weaknesses.trim();
      const hasExcellence = student.excellence && student.excellence.trim();
      
      // ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø£Ø¯Ø§Ø¡ ÙÙŠ ÙƒÙ„ Ù…Ø¬Ø§Ù„
      const examsPercent = ((student.exams || 0) / 20) * 100;
      const practicalPercent = ((student.practical || 0) / 30) * 100;
      const homeworkPercent = ((student.homework || 0) / 30) * 100;
      const discussionPercent = ((student.discussion || 0) / 20) * 100;
      
      // ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…Ø¬Ø§Ù„Ø§Øª Ø§Ù„ØªÙŠ ØªØ­ØªØ§Ø¬ ØªØ­Ø³ÙŠÙ†
      const weakAreas = [];
      if (examsPercent < 75) weakAreas.push('Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª');
      if (practicalPercent < 75) weakAreas.push('Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ø¹Ù…Ù„ÙŠ');
      if (homeworkPercent < 75) weakAreas.push('Ø§Ù„ÙˆØ§Ø¬Ø¨Ø§Øª');
      if (discussionPercent < 75) weakAreas.push('Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© ÙˆØ§Ù„ØªÙØ§Ø¹Ù„ Ø§Ù„ØµÙÙŠ');
      
      // Ø¨Ù†Ø§Ø¡ Ø§Ù„Ø®Ø·Ø© Ø¨Ù†Ø§Ø¡Ù‹ ï¿½ï¿½Ù„Ù‰ Ø§Ù„ØªØ­Ù„ÙŠÙ„
      let plan = '';
      
      // Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø®Ø·Ø© Ø­Ø³Ø¨ Ø§Ù„Ù…Ø³ØªÙˆÙ‰
      if (total >= 90) {
        plan += 'ğŸ† Ø®Ø·Ø© Ø¥Ø«Ø±Ø§Ø¦ÙŠØ© Ù„Ù„Ø­ÙØ§Ø¸ Ø¹Ù„Ù‰ Ø§Ù„ØªÙ…ÙŠØ²:\n\n';
      } else if (total >= 75) {
        plan += 'ğŸ“ˆ Ø®Ø·Ø© ØªØ·ÙˆÙŠØ±ÙŠØ© Ù„Ù„ÙˆØµÙˆÙ„ Ù„Ù„ØªÙ…ÙŠØ²:\n\n';
      } else if (total >= 60) {
        plan += 'ğŸ’ª Ø®Ø·Ø© Ø¹Ù„Ø§Ø¬ÙŠØ© Ù„ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø£Ø¯Ø§Ø¡:\n\n';
      } else {
        plan += 'ğŸ†˜ Ø®Ø·Ø© Ø¹Ù„Ø§Ø¬ÙŠØ© Ù…ÙƒØ«ÙØ©:\n\n';
      }
      
      // Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ø£ÙˆÙ„: Ù†Ù‚Ø§Ø· Ø§Ù„Ù‚ÙˆØ© (Ø¥Ù† ÙˆØ¬Ø¯Øª)
      if (hasExcellence || hasStrengths) {
        plan += 'âœ¨ Ø§Ù„Ø§Ø³ØªÙØ§Ø¯Ø© Ù…Ù† Ù†Ù‚Ø§Ø· Ø§Ù„ØªÙ…ÙŠØ² ÙˆØ§Ù„Ù‚ÙˆØ©:\n';
        if (hasExcellence) {
          plan += `â€¢ Ø§Ù„Ø§Ø³ØªÙ…Ø±Ø§Ø± ÙÙŠ ØªØ·ÙˆÙŠØ±: ${student.excellence.split('â€¢').filter(p => p.trim()).map(p => p.trim()).join(' Ùˆ')}\n`;
        }
        if (hasStrengths) {
          plan += `â€¢ Ø§Ù„Ø¨Ù†Ø§Ø¡ Ø¹Ù„Ù‰: ${student.strengths.split('â€¢').filter(p => p.trim()).map(p => p.trim()).join(' Ùˆ')}\n`;
        }
        plan += '\n';
      }
      
      // Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ø«Ø§Ù†ÙŠ: Ù…Ø¹Ø§Ù„Ø¬Ø© Ù†Ù‚Ø§Ø· Ø§Ù„Ø¶Ø¹Ù
      if (hasWeaknesses || weakAreas.length > 0) {
        plan += 'ğŸ“‹ Ù…Ø¹Ø§Ù„Ø¬Ø© Ù†Ù‚Ø§Ø· Ø§Ù„Ø¶Ø¹Ù:\n';
        
        if (hasWeaknesses) {
          const weakPoints = student.weaknesses.split('â€¢').filter(p => p.trim()).map(p => p.trim());
          weakPoints.forEach(point => {
            if (point.includes('Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©')) {
              plan += 'â€¢ ØªØ´Ø¬ÙŠØ¹ Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© Ù…Ù† Ø®Ù„Ø§Ù„ Ø£Ø³Ø¦Ù„Ø© Ù…Ø­ÙØ²Ø© ÙˆØ¨ÙŠØ¦Ø© Ø¯Ø§Ø¹Ù…Ø©\n';
            } else if (point.includes('Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ÙˆÙ‚Øª')) {
              plan += 'â€¢ ØªØ¯Ø±ÙŠØ¨ Ø¹Ù„Ù‰ Ù…Ù‡Ø§Ø±Ø§Øª Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ÙˆÙ‚Øª ÙˆØªÙ†Ø¸ÙŠÙ… Ø§Ù„Ù…Ù‡Ø§Ù…\n';
            } else if (point.includes('Ø§Ù„ØªÙÙƒÙŠØ± Ø§Ù„Ù†Ù‚Ø¯ÙŠ')) {
              plan += 'â€¢ Ø£Ù†Ø´Ø·Ø© ØªØ·Ø¨ÙŠÙ‚ÙŠØ© Ù„ØªÙ†Ù…ÙŠØ© Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„ØªÙÙƒÙŠØ± Ø§Ù„Ù†Ù‚Ø¯ÙŠ\n';
            } else if (point.includes('ØªÙ†Ø¸ÙŠÙ… Ø§Ù„Ø£ÙÙƒØ§Ø±')) {
              plan += 'â€¢ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø®Ø±Ø§Ø¦Ø· Ø°Ù‡Ù†ÙŠØ© ÙˆØ£Ø¯ÙˆØ§Øª ØªÙ†Ø¸ÙŠÙ… Ø§Ù„Ø£ÙÙƒØ§Ø±\n';
            } else if (point.includes('Ø§Ù„Ø«Ù‚Ø©')) {
              plan += 'â€¢ Ø¨Ù†Ø§Ø¡ Ø§Ù„Ø«Ù‚Ø© Ù…Ù† Ø®Ù„Ø§Ù„ ï¿½ï¿½Ù„ØªÙ‚Ø¯ÙŠÙ… Ø£Ù…Ø§Ù… Ù…Ø¬Ù…ÙˆØ¹ï¿½ï¿½Øª ØµØºÙŠØ±Ø© ØªØ¯Ø±ÙŠØ¬ÙŠØ§Ù‹\n';
            } else {
              plan += `â€¢ Ø§Ù„ØªØ±ÙƒÙŠØ² Ø¹Ù„Ù‰ ØªØ­Ø³ÙŠÙ†: ${point}\n`;
            }
          });
        }
        
        if (weakAreas.length > 0) {
          plan += `â€¢ Ù…Ø¹Ø§Ù„Ø¬Ø© Ù…ÙƒØ«ÙØ© ÙÙŠ: ${weakAreas.join(' Ùˆ ')}\n`;
        }
        plan += '\n';
      }
      
      // Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ø«Ø§Ù„Ø«: Ø®Ø·Ø© ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø¯Ø±Ø¬Ø§Øª Ø­Ø³Ø¨ Ø§Ù„Ù…Ø¬Ø§Ù„Ø§Øª Ø§Ù„Ø¶Ø¹ÙŠÙØ©
      if (weakAreas.length > 0) {
        plan += 'ğŸ¯ Ø®Ø·Ø© ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø£Ø¯Ø§Ø¡ Ø§Ù„Ø£ÙƒØ§Ø¯ÙŠÙ…ÙŠ:\n';
        
        if (examsPercent < 75) {
          plan += `â€¢ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª (${student.exams}/20): Ù…Ø±Ø§Ø¬Ø¹Ø© Ø¯ÙˆØ±ÙŠØ© + Ù†Ù…Ø§Ø°Ø¬ Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª ØªØ¯Ø±ÙŠØ¨ÙŠØ©\n`;
        }
        if (practicalPercent < 75) {
          plan += `â€¢ Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ø¹Ù…Ù„ÙŠ (${student.practical}/30): Ø¬Ù„Ø³Ø§Øª ØªØ·Ø¨ÙŠÙ‚ Ø¹Ù…Ù„ÙŠ Ø¥Ø¶Ø§ÙÙŠØ© + Ù…ØªØ§Ø¨Ø¹Ø© ÙØ±Ø¯ÙŠØ©\n`;
        }
        if (homeworkPercent < 75) {
          plan += `â€¢ Ø§Ù„ÙˆØ§Ø¬Ø¨Ø§Øª (${student.homework}/30): Ù…ØªØ§Ø¨Ø¹Ø© ÙŠÙˆÙ…ÙŠØ© + ØªÙ‚Ø¯ÙŠÙ… Ù†Ù…Ø§Ø°Ø¬ Ø¥Ø±Ø´Ø§Ø¯ÙŠØ©\n`;
        }
        if (discussionPercent < 75) {
          plan += `â€¢ Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© (${student.discussion}/20): ØªØ´Ø¬ÙŠØ¹ Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© + Ø£Ø³Ø¦Ù„Ø© Ù…ÙˆØ¬Ù‡Ø©\n`;
        }
        plan += '\n';
      }
      
      // Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ø±Ø§Ø¨Ø¹: Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„ØºÙŠØ§Ø¨ Ø¥Ù† ÙˆØ¬Ø¯
      if (attendanceRate < 90) {
        plan += 'âš ï¸ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„ØºÙŠØ§Ø¨:\n';
        plan += `â€¢ Ù†Ø³Ø¨Ø© Ø§Ù„Ø­Ø¶ÙˆØ± Ø§Ù„Ø­Ø§Ù„ÙŠØ©: ${attendanceRate.toFixed(0)}% (${attendance}/100 ÙŠÙˆÙ…)\n`;
        plan += 'â€¢ Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø± Ù„Ø¶Ù…Ø§Ù† Ø§Ù„Ø§Ù†ØªØ¸Ø§Ù…\n';
        plan += 'â€¢ ØªÙˆÙÙŠØ± Ù…Ù„Ø®ØµØ§Øª Ù„Ù„Ø¯Ø±ÙˆØ³ Ø§Ù„ÙØ§Ø¦ØªØ©\n';
        plan += 'â€¢ Ø¬Ø¯ÙˆÙ„Ø© Ø¬Ù„Ø³Ø§Øª ØªØ¹ÙˆÙŠØ¶ÙŠØ© Ø¹Ù†Ø¯ Ø§Ù„Ø­Ø§Ø¬Ø©\n\n';
      }
      
      // Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ø®Ø§Ù…Ø³: Ø§Ù„ØªÙˆØµÙŠØ§Øª Ø­Ø³Ø¨ Ø­Ø§Ù„Ø© Ø§Ù„Ø·Ø§Ù„Ø¨Ø©
      plan += 'ğŸ“Œ ï¿½ï¿½Ù„ØªÙˆØµÙŠØ§Øª ÙˆØ§Ù„Ù…ØªØ§Ø¨Ø¹Ø©:\n';
      
      if (student.studentStatus === 'Ù…ØªÙÙˆÙ‚Ø©') {
        plan += 'â€¢ Ù…Ø´Ø§Ø±ÙŠØ¹ ï¿½ï¿½Ø«Ø±Ø§Ø¦ÙŠØ© ØªØ­Ø¯ÙŠ Ù„ØªØ·ÙˆÙŠØ± Ø§Ù„Ù…Ù‡Ø§Ø±Ø§Øª\n';
        plan += 'â€¢ ØªÙƒÙ„ÙŠÙÙ‡Ø§ Ø¨Ù‚ÙŠØ§Ø¯Ø© Ù…Ø¬Ù…ÙˆØ¹Ø§Øª Ø¹Ù…Ù„\n';
        plan += 'â€¢ ØªÙˆØ¬ÙŠÙ‡Ù‡Ø§ Ù„Ù…Ø³Ø§Ø¨Ù‚Ø§Øª ÙˆÙ…Ø¨Ø§Ø¯Ø±Ø§Øª ØªÙ‚Ù†ÙŠØ©\n';
      } else if (student.studentStatus === 'ØªØ­ØªØ§Ø¬ Ø¯Ø¹Ù…') {
        plan += 'â€¢ Ù…ØªØ§Ø¨Ø¹Ø© ÙŠÙˆÙ…ÙŠØ© Ù…ÙƒØ«ÙØ©\n';
        plan += 'â€¢ Ø¬Ù„Ø³Ø§Øª Ø¯Ø¹Ù… ÙØ±Ø¯ÙŠØ© (3 Ù…Ø±Ø§Øª Ø£Ø³Ø¨ÙˆØ¹ÙŠØ§Ù‹)\n';
        plan += 'â€¢ ØªÙˆØ§ØµÙ„ Ø£Ø³Ø¨ÙˆØ¹ÙŠ Ù…Ø¹ ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø±\n';
        plan += 'â€¢ ØªØ¨Ø³ÙŠØ· Ø§Ù„Ù…Ù‡Ø§Ù… ÙˆØªÙ‚Ø³ÙŠÙ…Ù‡Ø§ Ù„Ø®Ø·ÙˆØ§Øª ØµØºÙŠØ±Ø©\n';
      } else if (student.studentStatus === 'Ù…ØªÙˆØ³Ø·Ø©') {
        plan += 'â€¢ Ù…ØªØ§Ø¨Ø¹Ø© Ø£Ø³Ø¨ÙˆØ¹ÙŠØ© Ù…Ù†ØªØ¸Ù…Ø©\n';
        plan += 'â€¢ Ø¬Ù„Ø³Ø§Øª Ø¯Ø¹Ù… Ø¹Ù†Ø¯ Ø§Ù„Ø­Ø§Ø¬Ø©\n';
        plan += 'â€¢ ØªØ´Ø¬ÙŠØ¹ ÙˆÙ…ØªØ§Ø¨Ø¹Ø© Ø§Ù„ØªÙ‚Ø¯Ù…\n';
      } else if (student.studentStatus === 'Ø¬ÙŠØ¯Ø©') {
        plan += 'â€¢ Ù…ØªØ§Ø¨Ø¹Ø© Ø¯ÙˆØ±ÙŠØ©\n';
        plan += 'â€¢ ØªØ­ÙÙŠØ² Ù„Ù„ÙˆØµÙˆÙ„ Ù„Ù„ï¿½ï¿½Ù…ÙŠØ²\n';
        plan += 'â€¢ Ø£Ù†Ø´Ø·Ø© Ø¥Ø«Ø±Ø§Ø¦ÙŠØ© ØªØ¯Ø±ÙŠØ¬ÙŠØ©\n';
      }
      
      // Ø§Ù„ØªØ¹Ø§ÙˆÙ† Ù…Ø¹ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø©
      if (student.teamwork) {
        plan += `â€¢ Ø§Ù„Ø§Ø³ØªÙØ§Ø¯Ø© Ù…Ù† Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ØªØ¹Ø§ÙˆÙ† (${student.teamwork}) ÙÙŠ Ø§Ù„Ø£Ù†Ø´Ø·Ø© Ø§Ù„Ø¬Ù…Ø§Ø¹ÙŠØ©\n`;
      }
      
      plan += '\nâ° Ù…Ø¯Ø© Ø§Ù„Ø®Ø·Ø©: ';
      if (total >= 75) {
        plan += 'Ø´Ù‡Ø± ÙˆØ§Ø­Ø¯ Ù…Ø¹ ØªÙ‚ÙŠÙŠÙ… Ù†ØµÙÙŠ';
      } else {
        plan += 'Ø´Ù‡Ø±ÙŠÙ† Ù…Ø¹ ØªÙ‚ÙŠÙŠÙ… Ø£Ø³Ø¨ÙˆØ¹ÙŠ';
      }
      
      showModal('Ø®Ø·Ø© Ø±ÙØ¹ Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ù…Ù‚ØªØ±Ø­Ø© ğŸ¯', `
        <div style="margin-bottom: 1.5rem;">
          <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--brand);">Ø§Ù„Ø·Ø§Ù„Ø¨Ø©:</label>
          <div style="padding: 0.75rem; background: #f5f9fc; border-radius: 8px; font-weight: 700; font-size: 1.05rem; color: var(--text);">
            ${student.name}
          </div>
        </div>
        
        <div style="background: linear-gradient(135deg, #e3f2fd, #e8eaf6); padding: 1rem; border-radius: 10px; margin-bottom: 1rem; border: 2px solid #90caf9;">
          <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 0.75rem;">
            <div style="background: white; padding: 0.5rem; border-radius: 6px; text-align: center;">
              <p style="font-size: 0.8rem; color: var(--muted); margin-bottom: 0.25rem;">Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹</p>
              <p style="font-size: 1.25rem; font-weight: 700; color: ${total >= 90 ? '#2e7d32' : total >= 75 ? '#1976d2' : total >= 60 ? '#f57c00' : '#d32f2f'};">${total}/100</p>
            </div>
            <div style="background: white; padding: 0.5rem; border-radius: 6px; text-align: center;">
              <p style="font-size: 0.8rem; color: var(--muted); margin-bottom: 0.25rem;">Ø§Ù„Ø­Ø¶ÙˆØ±</p>
              <p style="font-size: 1.25rem; font-weight: 700; color: ${attendanceRate >= 90 ? '#2e7d32' : attendanceRate >= 75 ? '#f57c00' : '#d32f2f'};">${attendanceRate.toFixed(0)}%</p>
            </div>
          </div>
        </div>
        
        <div style="margin-bottom: 1rem;">
          <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text);">Ø§Ù„Ø®Ø·Ø© Ø§Ù„Ù…Ù‚ØªØ±Ø­Ø©:</label>
          <textarea id="generatedPlan" style="width: 100%; min-height: 400px; padding: 12px; border: 1px solid #dfe7f1; border-radius: 10px; font-size: 0.95rem; line-height: 1.8; resize: vertical; font-family: 'Tajawal', sans-serif;">${plan}</textarea>
          <p style="font-size: 0.85rem; color: var(--muted); margin-top: 0.5rem; font-style: italic;">ğŸ’¡ ÙŠÙ…ÙƒÙ†Ùƒ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø®Ø·Ø© Ù‚Ø¨Ù„ Ø§Ù„Ø­ÙØ¸</p>
        </div>
      `, `
        <button onclick="savePlanFromModal(${index})">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„Ø®Ø·Ø©</button>
        <button class="ghost" onclick="closeModal()">Ø¥Ù„ØºØ§Ø¡</button>
      `);
    };
    
    window.savePlanFromModal = function(index) {
      const planText = document.getElementById('generatedPlan').value.trim();
      if (!planText) {
        showModal('ØªÙ†Ø¨ÙŠÙ‡', '<p style="text-align: center;">ÙŠØ±Ø¬Ù‰ ÙƒØªØ§Ø¨Ø© Ø®Ø·Ø© Ù‚Ø¨Ù„ Ø§Ù„Ø­ÙØ¸</p>');
        return;
      }
      
      studentsData[index].improvementPlan = planText;
      
      // Ø­ÙØ¸ ÙÙŠ Ø³Ø¬Ù„ Ø§Ù„Ø®Ø·Ø·
      if (!studentsData[index].planHistory) {
        studentsData[index].planHistory = [];
      }
      studentsData[index].planHistory.push({
        date: new Date().toISOString(),
        plan: planText,
        totalScore: (studentsData[index].exams || 0) + (studentsData[index].practical || 0) + (studentsData[index].homework || 0) + (studentsData[index].discussion || 0)
      });
      
      saveData();
      closeModal();
      showModal('ØªÙ… Ø§Ù„Ø­ÙØ¸', '<p style="text-align: center; color: #2e7d32;">âœ… ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø®Ø·Ø© Ø¨Ù†Ø¬Ø§Ø­ ÙˆØ¥Ø¶Ø§ÙØªÙ‡Ø§ Ù„Ù„Ø³Ø¬Ù„</p>');
      setTimeout(closeModal, 1500);
    };

    window.viewPlanHistory = function(index) {
      showModal('Ø³Ø¬Ù„ Ø§Ù„ï¿½ï¿½Ø·Ø·', `<p>Ø¹Ø±Ø¶ Ø³Ø¬Ù„ Ø®Ø·Ø· Ø§Ù„Ø·Ø§Ù„Ø¨Ø©: ${studentsData[index].name}</p>`);
    };

    window.analyzeStatus = function(index) {
      showModal('ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø­Ø§Ù„Ø©', `<p>ØªØ­Ù„ÙŠÙ„ Ø­Ø§Ù„Ø© Ø§Ù„Ø·Ø§Ù„Ø¨Ø©: ${studentsData[index].name}</p>`);
    };

    window.logContact = function(index) {
      const student = studentsData[index];
      showModal('ØªØ³Ø¬ÙŠÙ„ ØªÙˆØ§ØµÙ„ Ù…Ø¹ ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø±', `
        <div style="margin-bottom: 1.5rem;">
          <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--brand);">Ø§Ù„Ø·Ø§Ù„Ø¨Ø©:</label>
          <div style="padding: 0.75rem; background: #f5f9fc; border-radius: 8px; font-weight: 700; font-size: 1.05rem; color: var(--text);">
            ${student.name}
          </div>
        </div>
        
        <div style="margin-bottom: 1.5rem;">
          <label style="display: block; margin-bottom: 0.75rem; font-weight: 600; color: var(--text);">Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„ØªÙˆØ§ØµÙ„:</label>
          <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 0.75rem;">
            <label style="display: flex; align-items: center; gap: 0.5rem; padding: 0.75rem; background: #e3f2fd; border: 2px solid #90caf9; border-radius: 8px; cursor: pointer; transition: all 0.2s;">
              <input type="radio" name="contactMethod" value="Ù‡Ø§ØªÙ" style="width: 18px; height: 18px; cursor: pointer;">
              <span style="font-size: 1.3rem;">ğŸ“</span>
              <span style="flex: 1; font-weight: 600; color: #1565c0;">Ù‡Ø§ØªÙ</span>
            </label>
            
            <label style="display: flex; align-items: center; gap: 0.5rem; padding: 0.75rem; background: #dcf8e8; border: 2px solid #25D366; border-radius: 8px; cursor: pointer; transition: all 0.2s;">
              <input type="radio" name="contactMethod" value="ÙˆØ§ØªØ³ Ø¢Ø¨" style="width: 18px; height: 18px; cursor: pointer;">
              <span style="font-size: 1.3rem;">ğŸ’¬</span>
              <span style="flex: 1; font-weight: 600; color: #128C7E;">ÙˆØ§ØªØ³ Ø¢Ø¨</span>
            </label>
            
            <label style="display: flex; align-items: center; gap: 0.5rem; padding: 0.75rem; background: #fff3e0; border: 2px solid #ffb74d; border-radius: 8px; cursor: pointer; transition: all 0.2s;">
              <input type="radio" name="contactMethod" value="Ø¨Ø±ÙŠØ¯ Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ" style="width: 18px; height: 18px; cursor: pointer;">
              <span style="font-size: 1.3rem;">âœ‰ï¸</span>
              <span style="flex: 1; font-weight: 600; color: #e65100;">Ø¨Ø±ÙŠØ¯ Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</span>
            </label>
            
            <label style="display: flex; align-items: center; gap: 0.5rem; padding: 0.75rem; background: #f3e5f5; border: 2px solid #ba68c8; border-radius: 8px; cursor: pointer; transition: all 0.2s;">
              <input type="radio" name="contactMethod" value="Ø§Ø¬ØªÙ…Ø§Ø¹ Ù…Ø¨Ø§Ø´Ø±" style="width: 18px; height: 18px; cursor: pointer;">
              <span style="font-size: 1.3rem;">ğŸ‘¥</span>
              <span style="flex: 1; font-weight: 600; color: #7b1fa2;">Ø§Ø¬ØªÙ…Ø§Ø¹ Ù…Ø¨Ø§Ø´Ø±</span>
            </label>
          </div>
        </div>
        
        <div style="margin-bottom: 1rem;">
          <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text);">Ù…Ù„Ø®Øµ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©:</label>
          <textarea id="contactSummary" placeholder="Ø§ÙƒØªØ¨ Ù…Ù„Ø®Øµ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©..." style="width: 100%; min-height: 120px; padding: 12px; border: 1px solid #dfe7f1; border-radius: 10px; font-size: 1rem; resize: vertical; line-height: 1.6;"></textarea>
        </div>
      `, `
        <button onclick="saveContactLog(${index})">ğŸ’¾ Ø­ÙØ¸</button>
        <button class="ghost" onclick="closeModal()">Ø¥Ù„ØºØ§Ø¡</button>
      `);
    };

    window.saveContactLog = function(index) {
      const selectedMethod = document.querySelector('input[name="contactMethod"]:checked');
      const summary = document.getElementById('contactSummary').value.trim();
      
      if (!selectedMethod) {
        showModal('ØªÙ†Ø¨ÙŠÙ‡', '<p style="text-align: center;">ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„ØªÙˆØ§ØµÙ„</p>');
        return;
      }
      
      if (!summary) {
        showModal('ØªÙ†Ø¨ÙŠÙ‡', '<p style="text-align: center;">ÙŠØ±Ø¬Ù‰ ÙƒØªØ§Ø¨Ø© Ù…Ù„Ø®Øµ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©</p>');
        return;
      }
      
      if (!studentsData[index].contactHistory) {
        studentsData[index].contactHistory = [];
      }
      
      studentsData[index].contactHistory.push({
        date: new Date().toISOString(),
        method: selectedMethod.value,
        summary: summary
      });
      
      studentsData[index].parentContact = 'Ù†Ø¹Ù…';
      
      saveData();
      closeModal();
      showModal('ØªÙ… Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ø¨Ù†Ø¬Ø§Ø­! âœ…', `
        <div style="text-align: center; padding: 1rem;">
          <div style="font-size: 3rem; margin-bottom: 1rem;">âœ…</div>
          <p style="font-size: 1.1rem; color: #2e7d32; font-weight: 600;">ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„ØªÙˆØ§ØµÙ„ Ø¨Ù†Ø¬Ø§Ø­</p>
          <p style="color: var(--muted); margin-top: 0.5rem;">ØªÙ… ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„ØªÙˆØ§ØµÙ„ Ø¥Ù„Ù‰ "Ù†Ø¹Ù…"</p>
        </div>
      `);
      setTimeout(closeModal, 2000);
    };

    window.viewContactHistory = function(index) {
      const student = studentsData[index];
      const history = student.contactHistory || [];
      
      if (history.length === 0) {
        showModal('Ø³Ø¬Ù„ Ø§Ù„ØªÙˆØ§ØµÙ„', `
          <div style="text-align: center; padding: 2rem;">
            <div style="font-size: 3rem; margin-bottom: 1rem; opacity: 0.5;">ğŸ“‹</div>
            <p style="color: var(--muted);">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø³Ø¬Ù„Ø§Øª ØªÙˆØ§ØµÙ„ Ø¨Ø¹Ø¯</p>
            <p style="color: var(--muted); font-size: 0.9rem; margin-top: 0.5rem;">Ø§Ù„Ø·Ø§Ù„Ø¨Ø©: ${student.name}</p>
          </div>
        `);
        return;
      }
      
      const methodIcons = {
        'Ù‡Ø§ØªÙ': 'ğŸ“',
        'ÙˆØ§ØªØ³ Ø¢Ø¨': 'ğŸ’¬',
        'Ø¨Ø±ÙŠØ¯ Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ': 'âœ‰ï¸',
        'Ø§Ø¬ØªÙ…Ø§Ø¹ Ù…Ø¨Ø§Ø´Ø±': 'ğŸ‘¥'
      };
      
      const historyHTML = history.map((contact, i) => {
        const date = new Date(contact.date);
        const dateStr = date.toLocaleDateString('ar-SA', { year: 'numeric', month: 'long', day: 'numeric' });
        const timeStr = date.toLocaleTimeString('ar-SA', { hour: '2-digit', minute: '2-digit' });
        const icon = methodIcons[contact.method] || 'ğŸ“';
        
        return `
          <div style="background: white; padding: 1rem; border-radius: 10px; border-right: 4px solid ${i === 0 ? '#66bb6a' : '#90caf9'}; margin-bottom: 0.75rem;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
              <div style="display: flex; align-items: center; gap: 0.5rem;">
                <span style="font-size: 1.3rem;">${icon}</span>
                <span style="font-weight: 600; color: #1565c0;">${contact.method}</span>
              </div>
              <span style="font-size: 0.85rem; color: var(--muted);">${dateStr}</span>
            </div>
            <div style="font-size: 0.85rem; color: var(--muted); margin-bottom: 0.5rem;">${timeStr}</div>
            <p style="color: var(--text); line-height: 1.6; font-size: 0.95rem;">${contact.summary}</p>
          </div>
        `;
      }).join('');
      
      showModal(`Ø³Ø¬Ù„ Ø§Ù„ØªÙˆØ§ØµÙ„ - ${student.name}`, `
        <div style="margin-bottom: 1rem;">
          <div style="background: linear-gradient(135deg, #e8f5e9, #f1f8e9); padding: 1rem; border-radius: 10px; text-align: center; border: 2px solid #81c784;">
            <p style="font-size: 0.9rem; color: var(--muted); margin-bottom: 0.25rem;">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ØªÙˆØ§ØµÙ„Ø§Øª</p>
            <p style="font-size: 1.5rem; font-weight: 700; color: #2e7d32;">${history.length}</p>
          </div>
        </div>
        
        <div style="max-height: 400px; overflow-y: auto; padding-right: 0.5rem;">
          ${historyHTML}
        </div>
      `);
    };

    window.deleteStudent = function(index) {
      const student = studentsData[index];
      showModal('ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø°Ù', `
        <p style="text-align: center;">Ù‡Ù„ ØªØ±ÙŠØ¯ÙŠÙ† Ø­Ø°Ù Ø§Ù„Ø·Ø§Ù„Ø¨Ø©:</p>
        <p style="text-align: center; font-weight: 700; font-size: 1.1rem; margin-top: 0.5rem;">${student.name}</p>
      `, `
        <button class="danger" onclick="confirmDelete(${index})">ğŸ—‘ï¸ Ø­Ø°Ù</button>
        <button class="ghost" onclick="closeModal()">Ø¥Ù„ØºØ§Ø¡</button>
      `);
    };

    window.confirmDelete = function(index) {
      studentsData.splice(index, 1);
      saveData();
      closeModal();
      showModal('ØªÙ… Ø§Ù„Ø­Ø°Ù', '<p style="text-align: center; color: #2e7d32;">âœ… ØªÙ… Ø­Ø°Ù Ø§Ù„Ø·Ø§Ù„Ø¨Ø© Ø¨Ù†Ø¬Ø§Ø­</p>');
      setTimeout(closeModal, 1500);
    };

    // Ø¥Ø¶Ø§ÙØ© Ø·Ø§Ù„Ø¨Ø©
    document.getElementById('addStudentBtn').addEventListener('click', function() {
      showModal('Ø¥Ø¶Ø§ÙØ© Ø·Ø§Ù„Ø¨Ø© Ø¬Ø¯ÙŠØ¯Ø©', `
        <div style="margin-bottom: 1rem;">
          <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨Ø©:</label>
          <input id="newStudentName" type="text" placeholder="Ù…Ø«Ø§Ù„: Ø³Ø§Ø±Ø© Ù…Ø­Ù…Ø¯" style="width: 100%; padding: 10px; border: 1px solid #dfe7f1; border-radius: 8px;">
        </div>
        <div style="margin-bottom: 1rem;">
          <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Ø§Ù„ÙØµÙ„:</label>
          <input id="newStudentClass" type="text" placeholder="Ù…Ø«Ø§Ù„: Ø«Ø§Ù„Ø« 1" style="width: 100%; padding: 10px; border: 1px solid #dfe7f1; border-radius: 8px;">
        </div>
      `, `
        <button onclick="saveNewStudent()">â• Ø¥Ø¶Ø§ÙØ©</button>
        <button class="ghost" onclick="closeModal()">Ø¥Ù„ØºØ§Ø¡</button>
      `);
    });

    window.saveNewStudent = function() {
      const name = document.getElementById('newStudentName').value.trim();
      const studentClass = document.getElementById('newStudentClass').value.trim();
      
      if (!name || !studentClass) {
        showModal('ØªÙ†Ø¨ÙŠÙ‡', '<p style="text-align: center;">ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</p>');
        return;
      }

      studentsData.push({
        name: name,
        class: studentClass,
        exams: 0,
        practical: 0,
        homework: 0,
        discussion: 0,
        teamwork: '',
        excellence: '',
        strengths: '',
        weaknesses: '',
        improvementPlan: '',
        studentStatus: '',
        parentContact: 'Ù„Ø§',
        attendance: 0
      });
      saveData();
      closeModal();
      showModal('ØªÙ… Ø§Ù„Ø¥Ø¶Ø§ÙØ©', '<p style="text-align: center; color: #2e7d32;">âœ… ØªÙ… ï¿½ï¿½Ø¶Ø§ÙØ© Ø§Ù„Ø·Ø§Ù„Ø¨Ø© Ø¨Ù†Ø¬Ø§Ø­</p>');
      setTimeout(closeModal, 1500);
    };

    // Ø¨ÙŠØ§Ù†Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ©
    document.getElementById('demoBtn').addEventListener('click', function() {
      showModal('ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠï¿½ï¿½Ù†Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ©', `
        <p style="text-align: center; margin-bottom: 1rem;">Ù‡Ù„ ØªØ±ÙŠØ¯ÙŠÙ† ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ©ØŸ</p>
        <p style="text-align: center; color: var(--danger); font-size: 0.9rem;">âš ï¸ Ø³ÙŠØªÙ… Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©</p>
      `, `
        <button onclick="loadDemoData()">âœ… ØªØ­Ù…ÙŠÙ„</button>
        <button class="ghost" onclick="closeModal()">Ø¥Ù„ØºØ§Ø¡</button>
      `);
    });

    window.loadDemoData = function() {
      studentsData = [
        { name: 'Ø³Ø§Ø±Ø© Ù…Ø­Ù…Ø¯ Ø¹Ù„ÙŠ', class: 'Ø«Ø§Ù„Ø« 1', exams: 18, practical: 28, homework: 29, discussion: 19, attendance: 95, excellence: 'ØªÙ…ÙŠØ² ÙÙŠ Ø­Ù„ Ø§Ù„Ù…Ø´ÙƒÙ„Ø§Øª', strengths: 'Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… ÙˆØ§Ù„Ø§Ù†Ø¶Ø¨Ø§Ø·', weaknesses: 'ØªØ­ØªØ§Ø¬ Ù„ØªØ­Ø³ÙŠÙ† Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©', improvementPlan: 'ØªØ®ØµÙŠØµ ÙˆÙ‚Øª Ø¥Ø¶Ø§ÙÙŠ Ù„Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©', studentStatus: 'Ù…ØªÙÙˆÙ‚Ø©', parentContact: 'Ù†Ø¹Ù…', teamwork: 'Ù…Ù…ØªØ§Ø²' },
        { name: 'Ø±ÙŠÙ… Ø®Ø§Ù„Ø¯ Ù†Ø§ØµØ±', class: 'Ø«Ø§Ù„Ø« 1', exams: 14, practical: 22, homework: 24, discussion: 15, attendance: 88, excellence: '', strengths: 'Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„ÙØ¹Ø§Ù„Ø©', weaknesses: 'ØªØ­ØªØ§Ø¬ Ù„ØªÙ‚ÙˆÙŠØ© Ø§Ù„Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„Ø¹Ù…Ù„ÙŠØ©', improvementPlan: 'Ø¬Ù„Ø³Ø§Øª Ø¯Ø¹Ù… Ù…ÙƒØ«ÙØ©', studentStatus: 'Ø¬ÙŠØ¯Ø©', parentContact: 'Ù„Ø§', teamwork: 'Ø¬ÙŠØ¯' },
        { name: 'Ø¬ÙˆØ¯ Ø¹Ù…Ø± ØµØ§Ù„Ø­', class: 'Ø«Ø§Ù„Ø« 2', exams: 17, practical: 26, homework: 27, discussion: 16, attendance: 92, excellence: 'ØªÙ…ØªÙ„Ùƒ Ù…Ù‡Ø§Ø±Ø© Ø§Ù„ØªÙ‚Ø¯ÙŠÙ… Ø¨ÙˆØ¶ÙˆØ­', strengths: 'Ø¥ØªÙ‚Ø§Ù† Ø§Ù„Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„Ø¹Ù…Ù„ÙŠØ©', weaknesses: '', improvementPlan: 'Ø§Ù„Ø­ÙØ§Ø¸ Ø¹Ù„Ù‰ Ø§Ù„ØªÙ…ÙŠØ²', studentStatus: 'Ù…ØªÙÙˆÙ‚Ø©', parentContact: 'Ù†Ø¹Ù…', teamwork: 'Ø¬ÙŠØ¯ Ø¬Ø¯Ø§Ù‹' },
        { name: 'Ù„ÙŠÙ† Ø¹Ø§Ø¯Ù„ ÙÙ‡Ø¯', class: 'Ø«Ø§Ù„Ø« 2', exams: 20, practical: 30, homework: 30, discussion: 20, attendance: 98, excellence: 'Ù‚ÙŠØ§Ø¯Ø© ÙˆØ§Ø¶Ø­Ø© ÙÙŠ Ø§Ù„Ù…Ø´Ø§ï¿½ï¿½ÙŠØ¹', strengths: 'Ø³Ø±Ø¹Ø© Ø§Ø³ØªÙŠØ¹Ø§Ø¨ Ø§Ù„Ù…ÙØ§Ù‡ÙŠÙ…', weaknesses: '', improvementPlan: 'Ù…Ø´Ø§Ø±ÙŠØ¹ ØªØ­Ø¯ÙŠ Ø¥Ø¶Ø§ÙÙŠØ©', studentStatus: 'Ù…ØªÙÙˆÙ‚Ø©', parentContact: 'Ù†Ø¹Ù…', teamwork: 'Ù…Ù…ØªØ§Ø²' }
      ];
      saveData();
      closeModal();
      showModal('ØªÙ… Ø§Ù„ØªØ­Ù…ÙŠÙ„', '<p style="text-align: center; color: #2e7d32;">âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ©</p>');
      setTimeout(closeModal, 1500);
    };

    // Ù…Ø³Ø­ Ø§Ù„ÙƒÙ„
    document.getElementById('clearBtn').addEventListener('click', function() {
      showModal('ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ù…Ø³Ø­', `
        <p style="text-align: center; margin-bottom: 1rem;">Ù‡Ù„ Ø£Ù†ØªÙ Ù…ØªØ£ÙƒØ¯Ø© Ù…Ù† Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŸ</p>
        <p style="text-align: center; color: var(--danger); font-size: 0.9rem;">âš ï¸ Ù„ï¿½ï¿½ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù† Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡</p>
      `, `
        <button class="danger" onclick="confirmClearAll()">ğŸ—‘ï¸ Ù…Ø³Ø­ Ø§Ù„ÙƒÙ„</button>
        <button class="ghost" onclick="closeModal()">Ø¥Ù„ØºØ§Ø¡</button>
      `);
    });

    window.confirmClearAll = function() {
      studentsData = [];
      saveData();
      closeModal();
      showModal('ØªÙ… Ø§Ù„Ù…Ø³Ø­', '<p style="text-align: center; color: #2e7d32;">âœ… ØªÙ… Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</p>');
      setTimeout(closeModal, 1500);
    };

    // Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
    document.getElementById('saveDataBtn').addEventListener('click', function() {
      saveData();
      showModal('ØªÙ… Ø§Ù„Ø­ÙØ¸', '<p style="text-align: center; color: #2e7d32;">âœ… ØªÙ… Ø­ÙØ¸ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­</p>');
      setTimeout(closeModal, 1500);
    });

    document.getElementById('saveAfterTableBtn').addEventListener('click', function() {
      saveData();
      showModal('ØªÙ… Ø§Ù„Ø­ÙØ¸', '<p style="text-align: center; color: #2e7d32;">âœ… ØªÙ… Ø­ÙØ¸ Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª Ø¨Ù†Ø¬Ø§Ø­</p>');
      setTimeout(closeModal, 1500);
    });

    // Ø§Ø³ØªÙŠØ±Ø§Ø¯ Excel (Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ø§Ù„Ø¨Ø§Øª) - Ù…Ø¹ ØªØµØ­ÙŠØ­ Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©
    document.getElementById('importExcel').addEventListener('click', function() {
      document.getElementById('excelFileInput').click();
    });

    document.getElementById('excelFileInput').addEventListener('change', function(e) {
      const file = e.target.files[0];
      if (!file) return;
      
      const reader = new FileReader();
      reader.onload = function(event) {
        try {
          const data = new Uint8Array(event.target.result);
          const workbook = XLSX.read(data, { type: 'array', cellText: false, cellDates: true });
          const sheetName = workbook.SheetNames[0];
          const worksheet = workbook.Sheets[sheetName];
          
          // Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø¹ ØªØ­ÙˆÙŠÙ„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù‚ÙŠÙ… Ø¥Ù„Ù‰ Ù†ØµÙˆØµ
          const jsonData = XLSX.utils.sheet_to_json(worksheet, { 
            defval: '',
            raw: false // Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„Ù…Ù†Ø³Ù‚Ø© Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† Ø§Ù„Ø®Ø§Ù…
          });
          
          console.log('ğŸ“Š Ø¹Ø¯Ø¯ Ø§Ù„ØµÙÙˆÙ:', jsonData.length);
          
          if (jsonData.length === 0) {
            showModal('Ø®Ø·Ø£', '<p style="text-align: center; color: var(--danger);">âŒ Ø§Ù„Ù…Ù„Ù ÙØ§Ø±Øº Ø£Ùˆ Ù„Ø§ ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª</p>');
            return;
          }
          
          console.log('ğŸ” Ø§Ù„Ø£Ø¹ï¿½ï¿½Ø¯Ø© Ø§Ù„Ù…ØªÙˆÙØ±Ø©:', Object.keys(jsonData[0]));
          console.log('ğŸ“„ Ø£ÙˆÙ„ ØµÙ:', jsonData[0]);
          
          const imported = [];
          const errors = [];
          
          // Ø¯Ø§Ù„Ø© Ù…Ø³Ø§Ø¹Ø¯Ø© Ù„Ù„Ø¨Ø­Ø« Ø¹Ù† Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¹Ù…ÙˆØ¯ Ù…Ø¹ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø£ÙØ¶Ù„
          const getColumnValue = (row, ...possibleNames) => {
            for (const name of possibleNames) {
              const value = row[name];
              if (value !== undefined && value !== null && value !== '') {
                const strValue = String(value).trim();
                if (strValue && strValue !== 'undefined' && strValue !== 'null') {
                  return strValue;
                }
              }
            }
            return '';
          };
          
          jsonData.forEach((row, index) => {
            const rowNumber = index + 2;
            
            // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ø§Ø³Ù… Ø¨Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø´ÙƒØ§Ù„ Ø§Ù„Ù…Ù…ÙƒÙ†Ø©
            const studentName = getColumnValue(row, 
              'Ø§Ù„Ø§Ø³Ù…', 'Ø§Ø³Ù…', 'Ø§Ù„Ø£Ø³Ù…', 'name', 'Name', 'NAME',
              'Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨Ø©', 'Ø§Ù„Ø·Ø§Ù„Ø¨Ø©', 'Student', 'Student Name'
            );
            
            // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„ÙØµÙ„ Ø¨Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø´ÙƒØ§Ù„ Ø§Ù„Ù…Ù…ÙƒÙ†Ø©
            const studentClass = getColumnValue(row, 
              'Ø§Ù„ÙØµÙ„', 'ÙØµÙ„', 'class', 'Class', 'CLASS',
              'Ø§Ù„ØµÙ', 'ØµÙ', 'Grade', 'grade'
            );
            
            console.log(`Ø§Ù„ØµÙ ${rowNumber}: Ø§Ù„Ø§Ø³Ù…="${studentName}", Ø§Ù„ÙØµÙ„="${studentClass}"`);
            
            if (!studentName || !studentClass) {
              const missingFields = [];
              if (!studentName) missingFields.push('Ø§Ù„Ø§Ø³Ù…');
              if (!studentClass) missingFields.push('Ø§Ù„ÙØµÙ„');
              errors.push(`Ø§Ù„ØµÙ ${rowNumber}: ${missingFields.join(' Ùˆ ')} Ù…ÙÙ‚ÙˆØ¯/Ù…ÙÙ‚ÙˆØ¯Ø©`);
              return;
            }
            
            const student = {
              name: studentName,
              class: studentClass,
              exams: parseInt(getColumnValue(row, 'Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª', 'exams', 'Exams', 'Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª', 'Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±', 'test', 'Test')) || 0,
              practical: parseInt(getColumnValue(row, 'Ø§Ù„Ø¹Ù…Ù„ÙŠ', 'practical', 'Practical', 'Ø¹Ù…Ù„ÙŠ', 'Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ø¹Ù…Ù„ÙŠ', 'Ø§Ù„Ø¹Ù…Ù„ÙŠØ©')) || 0,
              homework: parseInt(getColumnValue(row, 'Ø§Ù„ï¿½ï¿½Ø§ï¿½ï¿½Ø¨Ø§Øª', 'homework', 'Homework', 'ÙˆØ§Ø¬Ø¨Ø§Øª', 'Ø§Ù„ÙˆØ§Ø¬Ø¨', 'assignments')) || 0,
              discussion: parseInt(getColumnValue(row, 'Ø§Ù„Ù…Ù†ï¿½ï¿½Ù‚Ø´Ø§Øª', 'discussion', 'Discussion', 'Ù…Ù†Ø§Ù‚Ø´Ø§Øª', 'Ø§Ù„ØªÙØ§Ø¹Ù„ Ø§Ù„ØµÙÙŠ', 'Ø§Ù„ØªÙØ§Ø¹Ù„', 'Ø§Ù„Ù…Ù†Ø§Ù‚Ø´Ø©')) || 0,
              teamwork: getColumnValue(row, 'Ø§Ù„ØªØ¹Ø§ÙˆÙ†', 'teamwork', 'Teamwork', 'ØªØ¹Ø§ÙˆÙ†', 'Ø§Ù„Ø¹Ù…Ù„ Ø§Ù„Ø¬Ù…Ø§Ø¹ÙŠ', 'Collaboration'),
              excellence: getColumnValue(row, 'Ù†Ù‚Ø§Ø· Ø§Ù„ØªÙ…ÙŠØ²', 'excellence', 'Excellence', 'ØªÙ…ÙŠØ²', 'Ø§Ù„ØªÙ…ÙŠØ²', 'Excellence Points'),
              strengths: getColumnValue(row, 'Ù†Ù‚Ø§Ø· Ø§Ù„Ù‚ÙˆØ©', 'strengths', 'Strengths', 'Ù‚ÙˆØ©', 'Ø§Ù„Ù‚ÙˆØ©', 'Strong Points'),
              weaknesses: getColumnValue(row, 'Ù†Ù‚Ø§Ø· Ø§Ù„Ø¶Ø¹Ù', 'weaknesses', 'Weaknesses', 'Ø¶Ø¹Ù', 'Ø§Ù„Ø¶Ø¹Ù', 'Weak Points'),
              improvementPlan: getColumnValue(row, 'Ø®Ø·Ø© Ø±ÙØ¹ Ø§Ù„Ù…Ø³ØªÙˆÙ‰', 'improvementPlan', 'plan', 'Plan', 'Ø®Ø·Ø©', 'Ø§Ù„Ø®Ø·Ø© ï¿½ï¿½Ù„Ø¹Ù„Ø§Ø¬ÙŠØ©', 'Ø§Ù„Ø®Ø·Ø©', 'Improvement Plan'),
              studentStatus: getColumnValue(row, 'Ø­Ø§Ù„Ø© Ø§Ù„Ø·Ø§Ù„Ø¨Ø©', 'studentStatus', 'status', 'Status', 'Ø­Ø§Ù„Ø©', 'Ø§Ù„Ø­Ø§Ù„Ø©', 'Student Status'),
              parentContact: getColumnValue(row, 'ØªÙˆØ§ØµÙ„ ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø±', 'parentContact', 'contact', 'Contact', 'ØªÙˆØ§ØµÙ„', 'Ø§Ù„ØªÙˆØ§ØµÙ„', 'Parent Contact') || 'Ù„Ø§',
              attendance: parseInt(getColumnValue(row, 'Ø§Ù„Ø­Ø¶ÙˆØ±', 'attendance', 'Attendance', 'Ø­Ø¶ÙˆØ±', 'Ø§Ù„Ø­Ø¶ÙˆØ±', 'Present Days')) || 0
            };
            
            imported.push(student);
          });
          
          console.log('âœ… Ø¹Ø¯Ø¯ Ø§Ù„Ø·Ø§Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ø³ØªÙˆØ±Ø¯Ø©:', imported.length);
          console.log('âš ï¸ Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡:', errors.length);
          
          if (imported.length === 0) {
            let errorMessage = '<div style="text-align: center;">';
            errorMessage += '<p style="color: var(--danger); font-size: 1.2rem; margin-bottom: 1.5rem;"><strong>ï¿½ï¿½ï¿½ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª ØµØ§Ù„Ø­Ø©</strong></p>';
            
            errorMessage += '<div style="background: #fff3e0; padding: 1.25rem; border-radius: 10px; margin-bottom: 1.25rem; text-align: right;">';
            errorMessage += '<p style="font-weight: 700; margin-bottom: 0.75rem; color: #e65100;">ğŸ“‹ Ø§Ù„Ø£Ø¹Ù…Ø¯Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©:</p>';
            errorMessage += '<ul style="list-style: none; padding: 0; line-height: 2;">';
            errorMessage += '<li>âœ“ Ø¹Ù…ÙˆØ¯ "Ø§Ù„Ø§Ø³Ù…" Ø£Ùˆ "name"</li>';
            errorMessage += '<li>âœ“ Ø¹Ù…ÙˆØ¯ "Ø§Ù„ÙØµÙ„" Ø£Ùˆ "class"</li>';
            errorMessage += '</ul>';
            errorMessage += '</div>';
            
            if (jsonData.length > 0) {
              errorMessage += '<div style="background: #e3f2fd; padding: 1.25rem; border-radius: 10px; margin-bottom: 1.25rem; text-align: right;">';
              errorMessage += '<p style="font-weight: 700; margin-bottom: 0.75rem; color: #1976d2;">ğŸ” Ø§Ù„Ø£Ø¹Ù…Ø¯Ø© ÙÙŠ Ù…Ù„ÙÙƒ:</p>';
              errorMessage += '<div style="background: white; padding: 0.75rem; border-radius: 6px; font-size: 0.9rem; direction: ltr; text-align: left; font-family: monospace; max-height: 150px; overflow-y: auto;">';
              errorMessage += Object.keys(jsonData[0]).map(k => `"${k}"`).join(', ');
              errorMessage += '</div>';
              errorMessage += '</div>';
            }
            
            if (errors.length > 0) {
              errorMessage += '<div style="background: #ffebee; padding: 1.25rem; border-radius: 10px; text-align: right;">';
              errorMessage += '<p style="font-weight: 700; margin-bottom: 0.75rem; color: #c62828;">âš ï¸ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡:</p>';
              errorMessage += '<div style="max-height: 150px; overflow-y: auto; font-size: 0.9rem; line-height: 1.8;">';
              errorMessage += errors.map(e => `â€¢ ${e}`).join('<br>');
              errorMessage += '</div></div>';
            }
            
            errorMessage += '</div>';
            
            showModal('ÙØ´Ù„ Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ù…Ù„Ù', errorMessage);
            return;
          }
          
          studentsData = imported;
          saveData();
          
          let successMessage = `
            <div style="text-align: center; padding: 1.5rem;">
              <div style="font-size: 4rem; margin-bottom: 1.5rem;">ğŸ‰</div>
              <p style="font-size: 1.4rem; color: #2e7d32; font-weight: 700; margin-bottom: 0.75rem;">ØªÙ… Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø¨Ù†Ø¬Ø§Ø­!</p>
              <div style="background: #e8f5e9; padding: 1rem; border-radius: 10px; margin-top: 1rem;">
                <p style="font-size: 1.2rem; color: #2e7d32; font-weight: 600;">âœ… Ø§Ø³ØªÙŠØ±Ø§Ø¯ ${imported.length} Ø·Ø§Ù„Ø¨Ø©</p>
              </div>
          `;
          
          if (errors.length > 0) {
            successMessage += `
              <div style="background: #fff3e0; padding: 1rem; border-radius: 10px; margin-top: 1rem;">
                <p style="font-size: 0.95rem; color: #e65100;">âš ï¸ ØªÙ… ØªØ¬Ø§Ù‡Ù„ ${errors.length} ØµÙ (Ø¨ÙŠØ§Ù†Ø§Øª Ù†Ø§Ù‚ØµØ©)</p>
              </div>
            `;
          }
          
          successMessage += '</div>';
          
          showModal('Ù†Ø¬Ø­ Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯! ğŸ‰', successMessage);
          setTimeout(closeModal, 3500);
          
        } catch (error) {
          console.error('âŒ Ø®ï¿½ï¿½Ø£:', error);
          showModal('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ï¿½ï¿½Ø±Ø§Ø¡Ø©', `
            <div style="text-align: center; padding: 1rem;">
              <p style="color: var(--danger); font-size: 1.1rem; margin-bottom: 1rem;">âŒ ï¿½ï¿½Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù…Ù„Ù</p>
              <div style="background: #ffebee; padding: 1rem; border-radius: 10px; text-align: right;">
                <p style="font-size: 0.9rem; line-height: 1.6; margin-bottom: 0.5rem;"><strong>ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø®Ø·Ø£:</strong></p>
                <p style="font-size: 0.85rem; font-family: monospace; background: white; padding: 0.5rem; border-radius: 4px;">${error.message}</p>
                <p style="font-size: 0.85rem; margin-top: 0.75rem; color: #666;">ØªØ£ÙƒØ¯ÙŠ Ù…Ù† Ø£Ù† Ø§Ù„Ù…Ù„Ù Ø¨ØµÙŠØºØ© Excel ØµØ­ÙŠØ­Ø© (.xlsx)</p>
              </div>
            </div>
          `);
        }
      };
      reader.readAsArrayBuffer(file);
      e.target.value = '';
    });

    // Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø®Ø·Ø· Excel
    document.getElementById('importPlansExcel').addEventListener('click', function() {
      document.getElementById('plansExcelFileInput').click();
    });

    document.getElementById('plansExcelFileInput').addEventListener('change', function(e) {
      const file = e.target.files[0];
      if (!file) return;
      
      const reader = new FileReader();
      reader.onload = function(event) {
        try {
          const data = new Uint8Array(event.target.result);
          const workbook = XLSX.read(data, { type: 'array' });
          const sheetName = workbook.SheetNames[0];
          const worksheet = workbook.Sheets[sheetName];
          const jsonData = XLSX.utils.sheet_to_json(worksheet);
          
          if (jsonData.length === 0) {
            showModal('Ø®Ø·Ø£', '<p style="text-align: center; color: var(--danger);">Ù…Ù„Ù Excel ÙØ§Ø±Øº Ø£Ùˆ Ø¨ØµÙŠØºØ© ØºÙŠØ± ØµØ­ÙŠØ­Ø©</p>');
            return;
          }
          
          let updatedCount = 0;
          jsonData.forEach(row => {
            const studentName = row['Ø§ï¿½ï¿½Ø§Ø³Ù…'] || row['name'] || '';
            const improvementPlan = row['Ø®Ø·Ø© Ø±ÙØ¹ Ø§Ù„Ù…Ø³ØªÙˆÙ‰'] || row['Ø§Ù„Ø®Ø·Ø© Ø§Ù„Ø¹Ù„Ø§Ø¬ÙŠØ©'] || row['improvementPlan'] || row['plan'] || '';
            
            if (studentName && improvementPlan) {
              const studentIndex = studentsData.findIndex(s => s.name === studentName);
              if (studentIndex !== -1) {
                studentsData[studentIndex].improvementPlan = improvementPlan;
                updatedCount++;
              }
            }
          });
          
          if (updatedCount === 0) {
            showModal('ØªÙ†Ø¨ÙŠÙ‡', '<p style="text-align: center;">Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø£Ø³Ù…Ø§Ø¡ Ù…Ø·Ø§Ø¨Ù‚Ø©.<br>ØªØ£ÙƒØ¯ÙŠ Ù…Ù† Ø£Ù† Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ø·Ø§Ù„Ø¨Ø§Øª ÙÙŠ Ù…Ù„Ù Ø§Ù„Ø®Ø·Ø· Ù…Ø·Ø§Ø¨Ù‚Ø© Ù„Ù„Ø£Ø³Ù…Ø§Ø¡ ÙÙŠ Ø§Ù„Ù†Ø¸Ø§Ù…</p>');
            return;
          }
          
          saveData();
          showModal('ØªÙ… ØªØ­ï¿½ï¿½ÙŠØ« Ø§Ù„Ø®Ø·Ø· Ø¨Ù†Ø¬Ø§Ø­! ğŸ‰', `
            <div style="text-align: center; padding: 1rem;">
              <div style="font-size: 3rem; margin-bottom: 1rem;">âœ…</div>
              <p style="font-size: 1.1rem; color: #2e7d32; font-weight: 600;">ØªÙ… ØªØ­Ø¯ÙŠØ« ï¿½ï¿½Ù„Ø®Ø·Ø· Ø§Ù„Ø¹Ù„Ø§Ø¬ÙŠØ© Ù„Ù€ ${updatedCount} Ø·Ø§Ù„Ø¨Ø©!</p>
            </div>
          `);
          setTimeout(closeModal, 2000);
          
        } catch (error) {
          showModal('Ø®Ø·Ø£', '<p style="text-align: center; color: var(--danger);">Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù…Ù„Ù. ØªØ£ÙƒØ¯ÙŠ Ù…Ù† ØµÙŠØºØ© Ø§Ù„Ù…Ù„Ù</p>');
        }
      };
      reader.readAsArrayBuffer(file);
      e.target.value = '';
    });

    document.getElementById('importCSV').addEventListener('click', function() {
      showModal('Ø§Ø³ØªÙŠØ±Ø§Ø¯ CSV', '<p style="text-align: center;">ï¿½ï¿½Ø¸ÙŠÙØ© Ø§Ø³ØªÙŠØ±Ø§Ø¯ CSV Ù‚ÙŠØ¯ Ø§Ù„ØªØ·ÙˆÙŠØ±</p>');
    });

    document.getElementById('exportExcel').addEventListener('click', function() {
      showModal('ØªØµØ¯ÙŠØ± Excel', '<p style="text-align: center;">ÙˆØ¸ÙŠÙØ© ØªØµØ¯ÙŠØ± Excel Ù‚ÙŠØ¯ Ø§Ù„ØªØ·ÙˆÙŠØ±</p>');
    });

    document.getElementById('clearFilter').addEventListener('click', function() {
      renderTable();
      showModal('ØªÙ… Ø¥Ù„ØºØ§Ø¡ Ø§Ù„ÙÙ„ØªØ±', '<p style="text-align: center;">ØªÙ… Ø¹Ø±Ø¶ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø·Ø§Ù„Ø¨Ø§Øª</p>');
      setTimeout(closeModal, 1500);
    });

    document.getElementById('printSummary').addEventListener('click', function() {
      showModal('Ø·Ø¨Ø§Ø¹Ø© Ù…Ø®ï¿½ï¿½ØµØ±Ø©', '<p style="text-align: center;">ÙˆØ¸ÙŠÙØ© Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© Ù‚ÙŠØ¯ Ø§Ù„ØªØ·ÙˆÙŠØ±</p>');
    });

    // Ø¯Ø§Ù„Ø© Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ù…Ø¹Ù„Ù…Ø© Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§ï¿½ï¿½
    window.contactTeacherWhatsApp = function() {
      const phoneNumber = "966XXXXXXXXX";
      const studentName = document.getElementById('sName').textContent;
      const message = `Ø§Ù„Ø³Ù„Ø§Ù… Ø¹Ù„ÙŠÙƒÙ… Ù…Ø¹Ù„Ù…ØªÙŠ Ø§Ù„ÙØ§Ø¶Ù„Ø© ğŸŒ¸\n\nØ£Ù†Ø§ Ø§Ù„Ø·Ø§Ù„Ø¨Ø©: ${studentName}\nØ£Ø±ØºØ¨ ÙÙŠ Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹Ùƒ Ø¨Ø®ØµÙˆØµ Ù…Ø§Ø¯Ø© Ø§Ù„ØªÙ‚Ù†ÙŠØ© Ø§Ù„Ø±Ù‚Ù…ÙŠØ©.\n\nØ´ÙƒØ±Ø§Ù‹ Ù„Ùƒ ğŸ’š`;
      const whatsappURL = `https://wa.me/${phoneNumber}?text=${encodeURIComponent(message)}`;
      window.open(whatsappURL, '_blank', 'noopener,noreferrer');
    };

    // Ø¯Ø§Ù„Ø© Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø§Ø³ØªØ¨ÙŠØ§Ù† - Ø§Ù„Ø·Ø§Ù„Ø¨Ø©
    document.getElementById('submitSurvey').addEventListener('click', function() {
      const trait = document.getElementById('studentTrait').value;
      const skill = document.getElementById('studentSkill').value.trim();
      const strategy = document.getElementById('learningStrategy').value.trim();
      const hasAdditional = document.getElementById('hasAdditionalMethod').value;
      const additionalMethod = document.getElementById('additionalMethod').value.trim();
      const informParent = document.getElementById('informParent').value;
      const satisfaction = document.getElementById('satisfactionLevel').value;
      
      if (!trait || !skill || !hasAdditional || !informParent || !satisfaction) {
        showModal('ØªÙ†Ø¨ÙŠÙ‡', '<p style="text-align: center;">ÙŠØ±Ø¬Ù‰ Ø¥ÙƒÙ…Ø§Ù„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©</p>');
        return;
      }
      
      if (hasAdditional === 'Ù†Ø¹Ù…' && !additionalMethod) {
        showModal('ØªÙ†Ø¨ÙŠÙ‡', '<p style="text-align: center;">ÙŠØ±Ø¬Ù‰ ÙƒØªØ§Ø¨Ø© Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ©</p>');
        return;
      }
      
      showModal('ØªÙ… Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ø¨Ù†Ø¬Ø§Ø­! ğŸ‰', `
        <div style="text-align: center; padding: 1rem;">
          <div style="font-size: 3rem; margin-bottom: 1rem;">âœ…</div>
          <p style="font-size: 1.1rem; color: #2e7d32; font-weight: 600; margin-bottom: 1rem;">Ø´ÙƒØ±Ø§Ù‹ Ù„Ù…Ø´Ø§Ø±Ùƒï¿½ï¿½Ùƒ!</p>
          <p style="color: var(--muted); line-height: 1.6;">ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø§Ø³ØªØ¨ÙŠØ§Ù† Ø¨Ù†Ø¬Ø§Ø­.</p>
        </div>
      `);
      
      // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
      document.getElementById('studentTrait').value = '';
      document.getElementById('studentSkill').value = '';
      document.getElementById('learningStrategy').value = '';
      document.getElementById('hasAdditionalMethod').value = '';
      document.getElementById('additionalMethod').value = '';
      document.getElementById('informParent').value = '';
      document.getElementById('satisfactionLevel').value = '';
      document.getElementById('additionalMethodContainer').style.display = 'none';
    });

    // Ø¯Ø§Ù„Ø© Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø§Ø³ØªØ¨ÙŠØ§Ù† - ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø±
    document.getElementById('submitParentSurvey').addEventListener('click', function() {
      const strategy = document.getElementById('parentLearningStrategy').value.trim();
      const hasAdditional = document.getElementById('parentHasAdditionalMethod').value;
      const additionalMethod = document.getElementById('parentAdditionalMethod').value.trim();
      const informParent = document.getElementById('parentInformParent').value;
      const satisfaction = document.getElementById('parentSatisfactionLevel').value;
      
      if (!hasAdditional || !informParent || !satisfaction) {
        showModal('ØªÙ†Ø¨ÙŠÙ‡', '<p style="text-align: center;">ÙŠØ±Ø¬Ù‰ Ø¥ÙƒÙ…Ø§Ù„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©</p>');
        return;
      }
      
      if (hasAdditional === 'Ù†Ø¹Ù…' && !additionalMethod) {
        showModal('ØªÙ†Ø¨ÙŠÙ‡', '<p style="text-align: center;">ÙŠØ±Ø¬Ù‰ ÙƒØªØ§Ø¨Ø© Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ©</p>');
        return;
      }
      
      showModal('ØªÙ… Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ø¨Ù†Ø¬Ø§Ø­! ğŸ‰', `
        <div style="text-align: center; padding: 1rem;">
          <div style="font-size: 3rem; margin-bottom: 1rem;">âœ…</div>
          <p style="font-size: 1.1rem; color: #2e7d32; font-weight: 600; margin-bottom: 1rem;">Ø´ÙƒØ±Ø§Ù‹ Ù„Ù…Ø´Ø§Ø±Ùƒï¿½ï¿½ÙƒÙ…!</p>
          <p style="color: var(--muted); line-height: 1.6;">ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø§Ø³ØªØ¨ÙŠØ§Ù† Ø¨Ù†Ø¬Ø§Ø­.</p>
        </div>
      `);
      
      // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
      document.getElementById('parentLearningStrategy').value = '';
      document.getElementById('parentHasAdditionalMethod').value = '';
      document.getElementById('parentAdditionalMethod').value = '';
      document.getElementById('parentInformParent').value = '';
      document.getElementById('parentSatisfactionLevel').value = '';
      document.getElementById('parentAdditionalMethodContainer').style.display = 'none';
    });

    // Ø¯Ø§Ù„Ø© Ø¹Ø±Ø¶ ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø·Ø§Ù„Ø¨Ø©
    function displayStudentReport(student) {
      const total = (student.exams || 0) + (student.practical || 0) + (student.homework || 0) + (student.discussion || 0);
      const percentage = total;
      
      document.getElementById('sName').textContent = student.name;
      document.getElementById('sClass').textContent = student.class;
      document.getElementById('sTotal').textContent = total;
      document.getElementById('sProgress').style.width = percentage + '%';
      
      // Ø¹Ø±Ø¶ ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù…Ø¹Ù„Ù…Ø©
      document.getElementById('sExcellence').textContent = student.excellence || 'Ù„Ù… ÙŠØªÙ… Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ø¨Ø¹Ø¯';
      document.getElementById('sStrengths').textContent = student.strengths || 'Ù„Ù… ÙŠØªÙ… Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ø¨Ø¹Ø¯';
      document.getElementById('sWeaknesses').textContent = student.weaknesses || 'Ù„Ù… ÙŠØªÙ… Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ø¨Ø¹Ø¯';
      document.getElementById('sImprovementPlan').textContent = student.improvementPlan || 'Ù„Ù… ÙŠØªÙ… ÙˆØ¶Ø¹ Ø®Ø·Ø© Ø¨Ø¹Ø¯';
      
      // Ø¹Ø±Ø¶ Ø§Ù„ØªÙØ§ØµÙŠÙ„
      const detailsHTML = `
        <div style="display: grid; gap: 0.75rem;">
          <div style="display: flex; justify-content: space-between; padding: 0.75rem; background: white; border-radius: 8px; border-right: 4px solid #7cc4ad;">
            <span>Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª</span>
            <strong>${student.exams || 0} / 20</strong>
          </div>
          <div style="display: flex; justify-content: space-between; padding: 0.75rem; background: white; border-radius: 8px; border-right: 4px solid #9cc6e0;">
            <span>Ø§Ù„Ø¹Ù…Ù„ÙŠ</span>
            <strong>${student.practical || 0} / 30</strong>
          </div>
          <div style="display: flex; justify-content: space-between; padding: 0.75rem; background: white; border-radius: 8px; border-right: 4px solid #b7c3d0;">
            <span>Ø§Ù„ÙˆØ§Ø¬Ø¨Ø§Øª</span>
            <strong>${student.homework || 0} / 30</strong>
          </div>
          <div style="display: flex; justify-content: space-between; padding: 0.75rem; background: white; border-radius: 8px; border-right: 4px solid #7cc4ad;">
            <span>Ø§Ù„Ù…Ù†Ø§Ù‚Ø´Ø§Øª</span>
            <strong>${student.discussion || 0} / 20</strong>
          </div>
          <div style="display: flex; justify-content: space-between; padding: 0.75rem; background: white; border-radius: 8px; border-right: 4px solid #64b5f6;">
            <span>Ø§Ù„ØªØ¹Ø§ÙˆÙ† Ù…Ø¹ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø©</span>
            <strong>${student.teamwork || 'Ù„Ù… ÙŠØªÙ… Ø§Ù„ØªÙ‚ÙŠÙŠÙ…'}</strong>
          </div>
          <div style="display: flex; justify-content: space-between; padding: 0.75rem; background: white; border-radius: 8px; border-right: 4px solid #ba68c8;">
            <span>Ø­Ø§Ù„Ø© Ø§Ù„Ø·Ø§Ù„Ø¨Ø©</span>
            <strong>${student.studentStatus || 'Ù„Ù… ÙŠØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ¯'}</strong>
          </div>
          <div style="display: flex; justify-content: space-between; padding: 0.75rem; background: white; border-radius: 8px; border-right: 4px solid #ffd89b;">
            <span>Ø¹Ø¯Ø¯ Ø£ÙŠØ§Ù… Ø§Ù„Ø­Ø¶ÙˆØ±</span>
            <strong>${student.attendance || 0} ÙŠÙˆÙ…</strong>
          </div>
        </div>
      `;
      document.getElementById('sDetails').innerHTML = detailsHTML;
      
      // Ø±Ø³Ù… Ø§Ù„Ù…Ø®Ø·Ø· Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ
      const ctx = document.getElementById('studentChart').getContext('2d');
      
      const examsPercent = ((student.exams || 0) / 20) * 100;
      const practicalPercent = ((student.practical || 0) / 30) * 100;
      const homeworkPercent = ((student.homework || 0) / 30) * 100;
      const discussionPercent = ((student.discussion || 0) / 20) * 100;
      
      const needsSupport = examsPercent < 75 || practicalPercent < 75 || homeworkPercent < 75 || discussionPercent < 75;
      document.getElementById('needsSupportWarning').style.display = needsSupport ? 'block' : 'none';
      
      if (window.studentChartInstance) {
        window.studentChartInstance.destroy();
      }
      
      window.studentChartInstance = new Chart(ctx, {
        type: 'bar',
        data: {
          labels: ['Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª', 'Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ø¹Ù…Ù„ÙŠ', 'Ø§Ù„ÙˆØ§Ø¬Ø¨Ø§Øª', 'Ø§Ù„Øªï¿½ï¿½Ø§Ø¹Ù„ Ø§Ù„ØµÙÙŠ'],
          datasets: [{
            label: 'Ø§Ù„Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø¦ÙˆÙŠØ© (%)',
            data: [examsPercent, practicalPercent, homeworkPercent, discussionPercent],
            backgroundColor: [
              examsPercent >= 75 ? '#66bb6a' : '#ef5350',
              practicalPercent >= 75 ? '#42a5f5' : '#ef5350',
              homeworkPercent >= 75 ? '#ab47bc' : '#ef5350',
              discussionPercent >= 75 ? '#ffa726' : '#ef5350'
            ],
            borderColor: [
              examsPercent >= 75 ? '#4caf50' : '#f44336',
              practicalPercent >= 75 ? '#2196f3' : '#f44336',
              homeworkPercent >= 75 ? '#9c27b0' : '#f44336',
              discussionPercent >= 75 ? '#ff9800' : '#f44336'
            ],
            borderWidth: 2,
            borderRadius: 8
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: true,
          plugins: {
            legend: {
              display: true,
              position: 'top',
              labels: {
                font: { family: 'Tajawal', size: 13 },
                padding: 15,
                usePointStyle: true
              }
            }
          },
          scales: {
            y: {
              beginAtZero: true,
              max: 100,
              ticks: {
                font: { family: 'Tajawal', size: 12 },
                callback: function(value) { return value + '%'; }
              }
            },
            x: {
              ticks: { font: { family: 'Tajawal', size: 12 } }
            }
          }
        }
      });
      
      let tip = 'Ø§Ø³ØªÙ…Ø±ÙŠ ÙÙŠ Ø¨Ø°Ù„ Ø§Ù„Ø¬Ù‡Ø¯ ÙˆØ³ØªØ­Ù‚Ù‚ÙŠÙ† Ù†ï¿½ï¿½Ø§Ø¦Ø¬ Ø±Ø§Ø¦Ø¹Ø©! ğŸŒŸ';
      if (total >= 90) {
        tip = 'Ø£Ø¯Ø§Ø¡ Ù…Ù…ØªØ§Ø²! Ø§Ø³ØªÙ…Ø±ÙŠ ÙÙŠ Ø§Ù„ØªÙ…ÙŠØ² ÙˆØ§Ù„Ø­ÙØ§Ø¸ Ø¹Ù„Ù‰ Ù‡Ø°Ø§ Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø±Ø§Ø¦Ø¹! ğŸ†';
      } else if (total >= 80) {
        tip = 'Ø£Ø¯Ø§Ø¡ Ø¬ÙŠØ¯ Ø¬Ø¯Ø§Ù‹! Ø±ÙƒØ²ÙŠ Ø¹Ù„Ù‰ Ø§Ù„Ø¬ÙˆØ§Ù†Ø¨ Ø§Ù„ØªÙŠ ØªØ­ØªØ§Ø¬ ØªØ­Ø³ÙŠÙ† Ù„ØªØµÙ„ÙŠ Ù„Ù„ØªÙ…ÙŠØ² ï¿½ï¿½ï¿½';
      } else if (total >= 70) {
        tip = 'Ø£Ø¯Ø§Ø¡ Ø¬ÙŠØ¯! ÙŠÙ…ÙƒÙ†Ùƒ ØªØ­Ø³ÙŠÙ† Ù…Ø³ØªÙˆØ§Ùƒ Ø¨Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© ÙˆØ§Ù„Ù…Ù…ï¿½ï¿½Ø±Ø³Ø© ğŸ“š';
      } else {
        tip = 'Ù„Ø§ ØªØ³ØªØ³Ù„Ù…ÙŠ! Ø§Ø·Ù„Ø¨ÙŠ Ù…Ø³Ø§Ø¹Ø¯Ø© Ø§Ù„Ù…Ø¹Ù„Ù…Ø© ÙˆØ®ØµØµÙŠ ÙˆÙ‚ØªØ§Ù‹ Ø£ÙƒØ¨Ø± Ù„Ù„Ø¯Ø±Ø§Ø³Ø© ğŸ’¡';
      }
      document.getElementById('sTip').textContent = tip;
    }

    // Ø¯Ø§Ù„Ø© Ø¹Ø±Ø¶ ØªÙ‚Ø±ÙŠØ± ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø±
    function displayParentReport(student) {
      const total = (student.exams || 0) + (student.practical || 0) + (student.homework || 0) + (student.discussion || 0);
      
      document.getElementById('pName').textContent = student.name;
      document.getElementById('pClass').textContent = student.class;
      
      let tip = 'Ù†Ø´Ø¬Ø¹ÙƒÙ… Ø¹Ù„Ù‰ Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ø¨Ù†ØªÙƒÙ… ÙˆØ¯Ø¹Ù…Ù‡Ø§ ÙÙŠ Ù…Ø³ÙŠØ±ØªÙ‡Ø§ Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©! ğŸŒŸ';
      if (total >= 90) {
        tip = 'Ø§Ø¨Ù†ØªÙƒÙ… Ù…ØªÙÙˆÙ‚Ø©! Ø§Ø³ØªÙ…Ø±ÙˆØ§ ÙÙŠ ØªØ´Ø¬ÙŠØ¹Ù‡Ø§ ÙˆØ§Ù„Ø§Ø­ØªÙØ§Ø¡ Ø¨Ø¥Ù†Ø¬Ø§ï¿½ï¿½Ø§ØªÙ‡Ø§ ğŸ†';
      } else if (total >= 80) {
        tip = 'Ø£Ø¯Ø§Ø¡ Ø¬ÙŠØ¯! Ù†Ù†ØµØ­ Ø¨Ø§Ù„ØªÙˆØ§ØµÙ„ Ø§Ù„Ù…Ø³ØªÙ…Ø± Ù…Ø¹ Ø§Ù„Ù…Ø¹Ù„Ù…Ø© Ù„Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„ØªØ·ÙˆØ± ğŸ’ª';
      } else if (total >= 70) {
        tip = 'Ø§Ø¨Ù†ØªÙƒÙ… Ø¨Ø­Ø§Ø¬Ø© Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„Ø¯Ø¹Ù… ÙˆØ§Ù„Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ù…Ù†Ø²Ù„ÙŠØ©. Ù†Ù†ØµØ­ Ø¨ØªØ®ØµÙŠØµ ÙˆÙ‚Øª ÙŠÙˆÙ…ÙŠ Ù„Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© ğŸ“š';
      } else {
        tip = 'Ù†Ù†ØµØ­ Ø¨Ø§Ù„ØªÙˆØ§ØµÙ„ Ø§Ù„ÙÙˆØ±ÙŠ Ù…Ø¹ Ø§Ù„Ù…Ø¹Ù„Ù…Ø© ÙˆÙˆØ¶Ø¹ Ø®Ø·Ø© Ø¯Ø¹Ù… Ù…ÙƒØ«ÙØ© Ù…Ø¹ Ù…ØªØ§Ø¨Ø¹Ø© ÙŠÙˆÙ…ÙŠØ© ğŸ†˜';
      }
      
      const summaryHTML = `
        <div style="display: grid; gap: 1rem;">
          <div style="display: flex; justify-content: space-between; align-items: center; padding: 1rem; background: white; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.05);">
            <div>
              <p style="color: var(--muted); font-size: 0.9rem; margin-bottom: 0.25rem;">ï¿½ï¿½Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙƒÙ„ÙŠ</p>
              <p style="font-size: 1.75rem; font-weight: 700; color: var(--brand);">${total} / 100</p>
            </div>
            <div style="font-size: 2.5rem;">ğŸ“Š</div>
          </div>
          
          <div style="background: white; padding: 1rem; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.05);">
            <p style="color: var(--muted); font-size: 0.9rem; margin-bottom: 1rem;">ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø¯Ø±Ø¬Ø§Øª</p>
            <div style="display: grid; gap: 0.5rem;">
              <div style="display: flex; justify-content: space-between; padding: 0.5rem; background: #f8fafc; border-radius: 6px;">
                <span>Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª (20)</span>
                <strong style="color: var(--brand);">${student.exams || 0}</strong>
              </div>
              <div style="display: flex; justify-content: space-between; padding: 0.5rem; background: #f8fafc; border-radius: 6px;">
                <span>Ø§Ù„Ø¹Ù…Ù„ÙŠ (30)</span>
                <strong style="color: var(--brand);">${student.practical || 0}</strong>
              </div>
              <div style="display: flex; justify-content: space-between; padding: 0.5rem; background: #f8fafc; border-radius: 6px;">
                <span>Ø§Ù„ÙˆØ§Ø¬Ø¨Ø§Øª (30)</span>
                <strong style="color: var(--brand);">${student.homework || 0}</strong>
              </div>
              <div style="display: flex; justify-content: space-between; padding: 0.5rem; background: #f8fafc; border-radius: 6px;">
                <span>Ø§Ù„Ù…Ù†Ø§Ù‚Ø´Ø§Øª (20)</span>
                <strong style="color: var(--brand);">${student.discussion || 0}</strong>
              </div>
              <div style="display: flex; justify-content: space-between; padding: 0.5rem; background: #e3f2fd; border-radius: 6px;">
                <span>Ø§Ù„ØªØ¹Ø§ÙˆÙ† Ù…Ø¹ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø©</span>
                <strong style="color: #1976d2;">${student.teamwork || 'Ù„ï¿½ï¿½ ÙŠØªÙ… Ø§Ù„ØªÙ‚ÙŠÙŠÙ…'}</strong>
              </div>
              <div style="display: flex; justify-content: space-between; padding: 0.5rem; background: #f3e5f5; border-radius: 6px;">
                <span>Ø­Ø§Ù„Ø© Ø§Ù„Ø·Ø§Ù„Ø¨Ø©</span>
                <strong style="color: #7b1fa2;">${student.studentStatus || 'Ù„Ù… ÙŠØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ¯'}</strong>
              </div>
            </div>
          </div>
          
          <div style="background: white; padding: 1rem; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.05);">
            <div style="display: flex; justify-content: space-between; align-items: center;">
              <div>
                <p style="color: var(--muted); font-size: 0.9rem; margin-bottom: 0.25rem;">Ø¹Ø¯Ø¯ Ø£ÙŠØ§Ù… Ø§Ù„Ø­Ø¶ÙˆØ±</p>
                <p style="font-size: 1.5rem; font-weight: 700; color: #2e7d32;">${student.attendance || 0} ÙŠÙˆÙ…</p>
              </div>
              <div style="font-size: 2rem;">âœ…</div>
            </div>
          </div>
          
          <div style="background: ${student.parentContact === 'Ù†Ø¹Ù…' ? '#e8f5e9' : '#fff3e0'}; padding: 1rem; border-radius: 10px; border: 2px solid ${student.parentContact === 'Ù†Ø¹Ù…' ? '#81c784' : '#ffb74d'};">
            <div style="display: flex; justify-content: space-between; align-items: center;">
              <div>
                <p style="color: var(--muted); font-size: 0.9rem; margin-bottom: 0.25rem;">Ø­Ø§Ù„Ø© Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ù…Ø¹Ù„Ù…Ø©</p>
                <p style="font-size: 1.25rem; font-weight: 700; color: ${student.parentContact === 'Ù†Ø¹Ù…' ? '#2e7d32' : '#f57c00'};">${student.parentContact === 'Ù†Ø¹Ù…' ? 'ØªÙ… Ø§Ù„ØªÙˆØ§ØµÙ„ âœ“' : 'Ù„Ù… ÙŠØªÙ… Ø§Ù„ØªÙˆØ§ØµÙ„ Ø¨Ø¹Ø¯'}</p>
              </div>
              <div style="font-size: 2rem;">${student.parentContact === 'Ù†Ø¹Ù…' ? 'ğŸ’š' : 'ğŸ“'}</div>
            </div>
          </div>
          
          <div style="background: linear-gradient(135deg, #f3e5f5, #fce4ec); padding: 1rem; border-radius: 10px; border: 2px solid #ce93d8;">
            <h5 style="color: #8e24aa; margin-bottom: 0.75rem; font-size: 1rem;">ğŸ“ ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù…Ø¹Ù„Ù…Ø©</h5>
            
            <div style="background: white; padding: 0.75rem; border-radius: 8px; margin-bottom: 0.5rem; border-right: 4px solid #66bb6a;">
              <p style="font-weight: 600; color: #2e7d32; font-size: 0.85rem; margin-bottom: 0.25rem;">âœ¨ Ù†Ù‚Ø§Ø· Ø§Ù„ØªÙ…ÙŠØ²</p>
              <p style="color: var(--text); font-size: 0.9rem; line-height: 1.5;">${student.excellence || 'Ù„Ù… ÙŠØªÙ… Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ø¨Ø¹Ø¯'}</p>
            </div>
            
            <div style="background: white; padding: 0.75rem; border-radius: 8px; margin-bottom: 0.5rem; border-right: 4px solid #42a5f5;">
              <p style="font-weight: 600; color: #1565c0; font-size: 0.85rem; margin-bottom: 0.25rem;">ğŸ’ª Ù†Ù‚Ø§Ø· Ø§Ù„Ù‚ÙˆØ©</p>
              <p style="color: var(--text); font-size: 0.9rem; line-height: 1.5;">${student.strengths || 'Ù„Ù… ÙŠØªÙ… Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ø¨Ø¹Ø¯'}</p>
            </div>
            
            <div style="background: white; padding: 0.75rem; border-radius: 8px; margin-bottom: 0.5rem; border-right: 4px solid #ff7043;">
              <p style="font-weight: 600; color: #d84315; font-size: 0.85rem; margin-bottom: 0.25rem;">ğŸ“‹ Ù†Ù‚Ø§Ø· Ø§Ù„Ø¶Ø¹Ù</p>
              <p style="color: var(--text); font-size: 0.9rem; line-height: 1.5;">${student.weaknesses || 'Ù„Ù… ÙŠØªÙ… Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ø¨Ø¹Ø¯'}</p>
            </div>
            
            <div style="background: white; padding: 0.75rem; border-radius: 8px; border-right: 4px solid #9c27b0;">
              <p style="font-weight: 600; color: #6a1b9a; font-size: 0.85rem; margin-bottom: 0.25rem;">ğŸ¯ Ø§Ù„ï¿½ï¿½Ø·Ø© Ø§Ù„Ø¹Ù„Ø§Ø¬ÙŠØ©</p>
              <p style="color: var(--text); font-size: 0.9rem; line-height: 1.5;">${student.improvementPlan || 'Ù„Ù… ÙŠØªÙ… ÙˆØ¶Ø¹ Ø®Ø·Ø© Ø¨Ø¹Ø¯'}</p>
            </div>
          </div>
          
          <div style="background: #fef5e7; padding: 1rem; border-radius: 10px; border: 2px solid #ffd89b;">
            <div style="display: flex; align-items: center; gap: 0.75rem;">
              <div style="font-size: 1.5rem;">ğŸ’¡</div>
              <div>
                <p style="font-weight: 600; color: #d68910; font-size: 0.9rem; margin-bottom: 0.25rem;">Ù†ï¿½ï¿½ÙŠØ­Ø© Ù„ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø±</p>
                <p style="color: var(--text); font-size: 0.9rem; line-height: 1.5;">${tip}</p>
              </div>
            </div>
          </div>
        </div>
      `;
      document.getElementById('pSummary').innerHTML = summaryHTML;
    }

    // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø¹Ù†Ø¯ Ø§Ù„Ø¯Ø®ÙˆÙ„
    renderTable();
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9a4c9379a162f911',t:'MTc2NDE5MzU2MS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>

</html>
